SPNGFIMH ;WDE/SD OUTCOME GRID FOR FIM'S 9/19/2002
 ;;2.0;Spinal Cord Dysfunction;**19**;01/02/1997
EN ;
 D CALC^SPNGFIMI
 I $D(SPNGOAL)=0 D ZAP^SPNOGRDA Q
 I $G(SPNGOAL)="" D ZAP^SPNOGRDA Q
REASK ;
 W !,"You have entered an INPT REHAB FINISH or INPT FOLLOW/UP (END) or OUTPT"
 W !,"REHAB FINISH or OUTPT FOLLOW/UP (END) FIM for a patient who has a recorded"
 W !,"INPT GOAL or OUTPT GOAL FIM.  Do you want to see a comparison"
 W !,"template you can copy and paste into a CPRS progress note"
 S %=2
 D YN^DICN
 I %=0 W !!,"Answer with Yes or No." W !,*7 G REASK
 I %=-1 Q
 Q:%=2
 S XA=$S(SPNRSCO=4:"Finish",SPNRSCO=5:"F/U (END)",SPNRSCO=9:"Finish",SPNRSCO=10:"F/U (END)",1:"ERROR")
 ;ok now the mess spngoal is the goal fim da is the current fim
 I $D(IOF) W @IOF
 ;W !,"--------------------------------------------------------------"
 W !,?11,"|",?13,"Eating",?20,"|",?22,"Grmmg",?28,"|",?30,"Bathe"
 W ?36,"|",?38,"DUB",?42,"|",?44,"DLB",?48,"|",?50,"Toileting",?61,"|"
 W !,"--------------------------------------------------------------"
 W !,"|",XA,?11,"|",?16,SPNR1C1,?20,"|",?24,SPNR1C2,?28,"|",?32,SPNR1C3
 W ?36,"|",?39,SPNR1C4,?42,"|",?45,SPNR1C5,?48,"|",?54,SPNR1C6,?61,"|"
 ;W !,"--------------------------------------------------------------"
 W !,"|Goal",?11,"|",?16,SPNR2C1,?20,"|",?24,SPNR2C2,?28,"|",?32,SPNR2C3
 W ?36,"|",?39,SPNR2C4,?42,"|",?45,SPNR2C5,?48,"|",?54,SPNR2C6,?61,"|"
 W !,"--------------------------------------------------------------"
 W !,"|Difference",?11,"|",?16,SPNR3C1,?20,"|",?24,SPNR3C2,?28,"|",?32,SPNR3C3
 W ?36,"|",?39,SPNR3C4,?42,"|",?45,SPNR3C5,?48,"|",?54,SPNR3C6,?61,"|"
 ;W !,"--------------------------------------------------------------"
 ;GRID FIM25 TWO
 W !
 ;W !,"-----------------------------------------------------------------------"
 W !,?11,"|",?13,"Bldr",?18,"|",?21,"Bwl",?25,"|",?27,"BCWC Trf"
 W ?36,"|",?38,"Tlt Trf",?46,"|",?48,"TSh Trf",?56,"|"
 W ?58,"W WC",?63,"|",?65,"Strs |"
 W !,"-----------------------------------------------------------------------"
 W !,"|",XA,?11,"|",?15,SPNR4C1,?18,"|",?22,SPNR4C2,?25,"|",?30,SPNR4C3,?36,"|",?41,SPNR4C4
 W ?46,"|",?51,SPNR4C5,?56,"|",?60,SPNR4C6,?63,"|",?67,SPNR4C7,?70,"|"
 ;W !,"-----------------------------------------------------------------------"
 W !,"|Goal",?11,"|",?15,SPNR5C1,?18,"|",?22,SPNR5C2,?25,"|",?30,SPNR5C3,?36,"|",?41,SPNR5C4
 W ?46,"|",?51,SPNR5C5,?56,"|",?60,SPNR5C6,?63,"|",?67,SPNR5C7,?70,"|"
 W !,"-----------------------------------------------------------------------"
 W !,"|Difference",?11,"|",?15,SPNR6C1,?18,"|",?22,SPNR6C2,?25,"|",?30,SPNR6C3,?36,"|",?41,SPNR6C4
 W ?46,"|",?51,SPNR6C5,?56,"|",?60,SPNR6C6,?63,"|",?67,SPNR6C7,?70,"|"
 ;W !,"-----------------------------------------------------------------------"
 ;GRID FIM25 THREE
 W !
 ;W !,"-----------------------------------------------------------------------"
 W !,?11,"|",?13,"Compr",?19,"|",?21,"Expr",?26,"|",?28,"Soc"
 W ?32,"|",?34,"Prb Slv",?42,"|",?44,"Mem",?48,"|"
 W ?50,"Mtr",?55,"|",?57,"Cogn",?63,"|",?65,"Tot  |"
 W !,"-----------------------------------------------------------------------"
 W !,"|",XA,?11,"|",?15,SPNR7C1,?19,"|",?22,SPNR7C2,?26,"|",?29,SPNR7C3
 W ?32,"|",?37,SPNR7C4,?42,"|",?45,SPNR7C5,?48,"|",?50,SPNR7C6
 W ?55,"|",?57,SPNR7C7,?63,"|",?65,SPNR7C8,?70,"|"
 W !,"|Goal",?11,"|",?15,SPNR8C1,?19,"|",?22,SPNR8C2,?26,"|",?29,SPNR8C3
 W ?32,"|",?37,SPNR8C4,?42,"|",?45,SPNR8C5,?48,"|",?50,SPNR8C6
 W ?55,"|",?57,SPNR8C7,?63,"|",?65,SPNR8C8,?70,"|"
 W !,"-----------------------------------------------------------------------"
 W !,"|Difference",?11,"|",?15,SPNR9C1,?19,"|",?22,SPNR9C2,?26,"|",?29,SPNR9C3
 W ?32,"|",?37,SPNR9C4,?42,"|",?45,SPNR9C5,?48,"|",?50,SPNR9C6
 W ?55,"|",?57,SPNR9C7,?63,"|",?65,SPNR9C8,?70,"|"
 ;W !,"-----------------------------------------------------------------------"
 R !!?10,"Press Return to continue",SPNREAD:DTIME
 Q
FIM25 ;
 ;;EOR999
 Q
