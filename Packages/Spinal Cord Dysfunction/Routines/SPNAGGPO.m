SPNAGGPO ;SD/CM- PRINT AGGREGATE OUTPT OUTCOMES; 2-21-2003
 ;;2.0;Spinal Cord Dysfunction;**20,24**;01/02/97
 ;
PRINT ;
 S U="^"
 W !!
 S SPNPD0=0 F  S SPNPD0=$O(^SPNL(154.1,"B",SPNPD0)) Q:'+SPNPD0  D OIEN^SPNAGGO
 W !,?18,"OUTPATIENT Rehabilitation Outcomes Report"
 W !,?24,"Date of Report: ",$$FMTE^XLFDT($$NOW^XLFDT,"5DZP")
 W !,?12,"Based on Care End Dates from ",$$FMTE^XLFDT(BDATE,"5DZP")," to ",$$FMTE^XLFDT(EDATE,"5DZP"),!!
 S LINE="-" F I=1:1:80 W LINE
 W !,?SPNT1,"HI TETRA",?SPNT2,"LO TETRA",?SPNT3,"PARA",?SPNT4,"ASIA D",?SPNT5,"ALL",!
 W !,"# and % of Patients",?SPNT1,SPNSEVC," (",$S(+SPNDIAGC:$J(SPNSEVC/SPNDIAGC*100,2,0),1:0),"%)",?SPNT2,SPNMODC," (",$S(+SPNDIAGC:$J(SPNMODC/SPNDIAGC*100,2,0),1:0),"%)"
 W ?SPNT3,SPNPARC," (",$S(+SPNDIAGC:$J(SPNPARC/SPNDIAGC*100,2,0),1:0),"%)",?SPNT4,SPNLOWC," (",$S(+SPNDIAGC:$J(SPNLOWC/SPNDIAGC*100,2,0),1:0),"%)",?SPNT5,SPNDIAGC," (100%)"
 W !,"Age (yrs)",?SPNT1,$S(+SPNSEVC:$J(SPNAGES/SPNSEVC,3,1),1:"N/A"),?SPNT2,$S(+SPNMODC:$J(SPNAGEM/SPNMODC,3,1),1:"N/A"),?SPNT3,$S(+SPNPARC:$J(SPNAGEP/SPNPARC,3,1),1:"N/A"),?SPNT4,$S(+SPNLOWC:$J(SPNAGEL/SPNLOWC,3,1),1:"N/A")
 W ?SPNT5,$S(SPNDIAGC>0:$J(SPNAGES+SPNAGEM+SPNAGEP+SPNAGEL/SPNDIAGC,3,1),1:"N/A")
 W !,"Age Range",?SPNT1,MINAGES,"-",MAXAGES,?SPNT2,MINAGEM,"-",MAXAGEM,?SPNT3,MINAGEP,"-",MAXAGEP,?SPNT4,MINAGEL,"-",MAXAGEL,?SPNT5,AGEL,"-",AGEH
 W !,"Gender (% Male pts)",?SPNT1,$S(+SPNSEVC:$J(SPNSEXS/SPNSEVC*100,2,0)_"%",1:"N/A"),?SPNT2,$S(+SPNMODC:$J(SPNSEXM/SPNMODC*100,2,0)_"%",1:"N/A"),?SPNT3,$S(+SPNPARC:$J(SPNSEXP/SPNPARC*100,2,0)_"%",1:"N/A")
 W ?SPNT4,$S(+SPNLOWC:$J(SPNSEXL/SPNLOWC*100,2,0)_"%",1:"N/A")
 W ?SPNT5,$S(+SPNDIAGC:$J(SPNSEXS+SPNSEXM+SPNSEXP+SPNSEXL/SPNDIAGC*100,2,0)_"%",1:"N/A")
 ;W !,"Length of Rehab (days)",?SPNT1,$S(+LORSC:SPNLORS/LORSC,1:"N/A"),?SPNT2,$S(+LORMC:SPNLORM/LORMC,1:"N/A"),?SPNT3,$S(+LORPC:SPNLORP/LORPC,1:"N/A"),?SPNT4
 ;W $S(+LORLC:SPNLORL/LORLC,1:"N/A"),?SPNT5,$S(+(LORSC+LORMC+LORPC+LORLC):$J(SPNLORS+SPNLORM+SPNLORP+SPNLORL/(LORSC+LORMC+LORPC+LORLC),3,0),1:"N/A")
 ;W !,"Length of Rehab Range",?SPNT1,MINLORS,"-",MAXLORS,?SPNT2,MINLORM,"-",MAXLORM,?SPNT3,MINLORP,"-",MAXLORP,?SPNT4,MINLORL,"-",MAXLORL,?SPNT5,LORL,"-",LORH
 W !,"Total FIM Change",?SPNT1,$S(+TFCS:TFCUMS/TFCS,1:"N/A"),?SPNT2,$S(+TFCM:TFCUMM/TFCM,1:"N/A"),?SPNT3,$S(+TFCP:TFCUMP/TFCP,1:"N/A"),?SPNT4,$S(+TFCL:TFCUML/TFCL,1:"N/A")
 W ?SPNT5,$S(TFCS+TFCM+TFCP+TFCL>0:$J(TFCUMS+TFCUMM+TFCUMP+TFCUML/(TFCS+TFCM+TFCP+TFCL),3,1),1:"N/A")
 ;W !,"MSCIS Total FIM Change",?SPNT1,12.4,?SPNT2,27.8,?SPNT3,41.5,?SPNT4,41.2,?SPNT5,35.9
 ;W !,"FIM Efficiency",?SPNT1,$S(+SPNLORS:$J(TFCUMS/SPNLORS,3,2),1:"N/A"),?SPNT2,$S(+SPNLORM:$J(TFCUMM/SPNLORM,3,2),1:"N/A"),?SPNT3,$S(+SPNLORP:$J(TFCUMP/SPNLORP,3,2),1:"N/A")
 ;W ?SPNT4,$S(+SPNLORL:$J(TFCUML/SPNLORL,3,2),1:"N/A"),?SPNT5,$S(SPNLORS+SPNLORM+SPNLORP+SPNLORL>0:$J(TFCUMS+TFCUMM+TFCUMP+TFCUML/(SPNLORS+SPNLORM+SPNLORP+SPNLORL),3,2),1:"N/A")
 ;W !,"MSCIS FIM Efficiency",?SPNT1,"0.13",?SPNT2,"0.28",?SPNT3,"0.76",?SPNT4,"0.84",?SPNT5,"0.55"
 W !,"FIM Goal Attainment",?SPNT1,$S(+TFGCS:TFGCUMS/TFGCS,1:"N/A"),?SPNT2,$S(+TFGCM:TFGCUMM/TFGCM,1:"N/A"),?SPNT3,$S(+TFGCP:TFGCUMP/TFGCP,1:"N/A"),?SPNT4,$S(+TFGCL:TFGCUML/TFGCL,1:"N/A")
 W ?SPNT5,$S(TFGCS+TFGCM+TFGCP+TFGCL>0:$J(TFGCUMS+TFGCUMM+TFGCUMP+TFGCUML/(TFGCS+TFGCM+TFGCP+TFGCL),3,1),1:"N/A")
 ;W !,"% Discharged to Community",?SPNT1,$S(+COMDISS:COMDISS/LORSC*100_"%",1:"N/A"),?SPNT2,$S(+COMDISM:COMDISM/LORMC*100_"%",1:"N/A"),?SPNT3,$S(+COMDISP:COMDISP/LORPC*100_"%",1:"N/A"),?SPNT4,$S(+COMDISL:COMDISL/LORLC*100_"%",1:"N/A")
 ;W ?SPNT5,$S(LORSC+LORMC+LORPC+LORLC>0:$J(COMDISS+COMDISM+COMDISP+COMDISL/(LORSC+LORMC+LORPC+LORLC)*100,2,0)_"%",1:"N/A")
 W !,"FIM Durability",?SPNT1,$S(+TFUCS:TFUCUMS/TFUCS,1:"N/A"),?SPNT2,$S(+TFUCM:TFUCUMM/TFUCM,1:"N/A"),?SPNT3,$S(+TFUCP:TFUCUMP/TFUCP,1:"N/A"),?SPNT4,$S(+TFUCL:TFUCUML/TFUCL,1:"N/A")
 W ?SPNT5,$S(TFUCS+TFUCM+TFUCP+TFUCL>0:$J(TFUCUMS+TFUCUMM+TFUCUMP+TFUCUML/(TFUCS+TFUCM+TFUCP+TFUCL),3,1),1:"N/A")
 W !,"Diener SWLS Change",?SPNT1,$S(+SLCS:SLCUMS/SLCS,1:"N/A"),?SPNT2,$S(+SLCM:SLCUMM/SLCM,1:"N/A"),?SPNT3,$S(+SLCP:SLCUMP/SLCP,1:"N/A"),?SPNT4,$S(+SLCL:SLCUML/SLCL,1:"N/A")
 W ?SPNT5,$S(SLCS+SLCM+SLCP+SLCL>0:$J(SLCUMS+SLCUMM+SLCUMP+SLCUML/(SLCS+SLCM+SLCP+SLCL),3,1),1:"N/A")
 W !,"Diener SWLS Durability",?SPNT1,$S(+SLUCS:SLUCUMS/SLUCS,1:"N/A"),?SPNT2,$S(+SLUCM:SLUCUMM/SLUCM,1:"N/A"),?SPNT3,$S(+SLUCP:SLUCUMP/SLUCP,1:"N/A"),?SPNT4,$S(+SLUCL:SLUCUML/SLUCL,1:"N/A")
 W ?SPNT5,$S(SLUCS+SLUCM+SLUCP+SLUCL>0:$J(SLUCUMS+SLUCUMM+SLUCUMP+SLUCUML/(SLUCS+SLUCM+SLUCP+SLUCL),3,1),1:"N/A")
 Q
