SOWKLOC ;B'HAM ISC/SAB-Routine to inquire for patient's location ; 22 Jan 93 / 10:17 AM
 ;;3.0; Social Work ;;27 Apr 93
SEA W ! S DIC("A")="SELECT CASE: ",DIC="^SOWK(650,",DIC(0)="AQEM" D ^DIC G:"^"[X CLO G SEA:Y<0 S DA=+Y,A=^SOWK(650,DA,0)
 K %ZIS,IOP,ZTSK S SOWKION=ION,%ZIS="QM" D ^%ZIS K %ZIS I POP S IOP=SOWKION D ^%ZIS K IOP,SOWKION G CLO
 K SOWKION I $D(IO("Q")) S ZTDESC="PATIENT INQUIRY REPORT",ZTRTN="ENQ^SOWKLOC" F G="DA","DIC" S:$D(@G) ZTSAVE(G)=""
 I  K IO("Q") D ^%ZTLOAD W:$D(ZTSK) !!,"Task Queued to Print",! K G,DA,DIK,ZTSK G CLO Q
ENQ U IO W:$Y @IOF D EN^DIQ
CLO W:$E(IOST)'["C" @IOF D ^%ZISC K DA,DIC,A,IOP,POP,%ZIS,SWAL,SWCN,SWOD,SWPAT,SWW,X,Y,SWCD D:$D(ZTSK) KILL^%ZTLOAD Q
