GMRCS ;SLC/DLT - Review consults by Patient and Service ;5/20/98  14:20
 ;;3.0;CONSULT/REQUEST TRACKING;**1**;DEC 27, 1997
SELCT ;Select a Consult Type from the protocol file
 S DIC=101,DIC(0)="AEMQZ",DIC("A")="Select Consult Type: ",DIC("B")="GMRCT TPN" D ^DIC K DIC Q:Y<0  S GMRCCT=+7
 Q
SELPT K DIC S DIC=2,DIC("A")="Select Patient: ",DIC(0)="AEQM" D ^DIC K DIC S DFN=+Y
 I X="^"!(Y=-1) S GMRCQUT=1 K DFN Q
 D DEM^GMRCU
 Q
SELPR ;Get Procedure
 K GMRCPRNM,GMRCQUT
 S Y=$O(^ORD(101,"B","GMRCRM MEDICINE REQUEST TYPES",0)) Q:Y=""
 S XQORM=+Y_";ORD(101,",XQORM(0)="1A\",XQORM("A")="Select Procedure: ",XQORM("NO^^")=""
 D EN^XQORM K XQORM I Y<0 S GMRCQUT=1 K GMRCPR,GMRCPRNM,GMRCCT Q
 S GMRCPR=$P(Y(1),"^",2)
 Q
EXIT ;Exit action logic
 K GMRCA,GMRCACT,GMRCACTM,GMRCAGE,GMRCCT,GMRCCTX,GMRCDG,GMRCDGT,GMRCDOB,GMRCDTM,GMRCGRP,GMRCH,GMRCHDR,GMRCIFN,GMRCLFG,GMRCNM,GMRCNPG,GMRCPG,GMRCPNM,GMRCPR,GMRCRB,GMRCRPG
 K GMRCSN,GMRCSS,GMRCSSNM,GMRCTC,GMRCTITL,GMRCTM,GMRCTYPE,GMRCVP,GMRCWARD,SEX,VAROOT,W
 K DFN,HEAD,GMRCEND,GMRCORNP,GMRCORVP,GETPROV,GMRCDEV,GMRCDIC,GMRCPLI,GMRCPRI,GMRCURGI,GMRCGL,GMRCSR,GMRCSRDT,GMRCSRS,GMRCORVP,LASTA,MCBRANCH,MCC,MCK,MCPROC
 K O,ORGY,ORL,ORNP,ORNS,OREND,ORIOSL,ORPK,ORTKG,ORTO,ORTX,ORSTS,ORACTION,ORANSI,ORATTEND,ORI,ORSSN,ORTIT,ORTS,ORINDX,Z,ZTDESC
 Q
