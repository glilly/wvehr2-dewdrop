FSCXREFR ;SLC/STAFF-NOIS Xrefs Call Refer Status ;1/11/98  15:27
 ;;1.1;NOIS;;Sep 06, 1998
 ;
ARM(OP,FIELD,VALUE,CALL) ; from dd 7100
 N MOD,STATUS
 I OP="SET" D  Q
 .I FIELD="STATUS" D  Q
 ..I VALUE=3 S MOD=$P(^FSCD("CALL",CALL,0),U,8) I MOD S ^FSCD("CALL","ARM",MOD,CALL)=""
 .I FIELD="MOD" D  Q
 ..I VALUE S STATUS=$P(^FSCD("CALL",CALL,0),U,2) I STATUS=3 S ^FSCD("CALL","ARM",VALUE,CALL)=""
 I OP="KILL" D  Q
 .I FIELD="STATUS" D  Q
 ..S MOD=$P(^FSCD("CALL",CALL,0),U,8) I MOD K ^FSCD("CALL","ARM",MOD,CALL)
 .I FIELD="MOD" D  Q
 ..K ^FSCD("CALL","ARM",VALUE,CALL)
 Q
 ;
ARP(OP,FIELD,VALUE,CALL) ; from dd 7100
 N PACK,STATUS
 I OP="SET" D  Q
 .I FIELD="STATUS" D  Q
 ..I VALUE=3 S PACK=$P(^FSCD("CALL",CALL,120),U,9) I PACK S ^FSCD("CALL","ARP",PACK,CALL)=""
 .I FIELD="PACK" D  Q
 ..I VALUE S STATUS=$P(^FSCD("CALL",CALL,0),U,2) I STATUS=3 S ^FSCD("CALL","ARP",VALUE,CALL)=""
 I OP="KILL" D  Q
 .I FIELD="STATUS" D  Q
 ..S PACK=$P(^FSCD("CALL",CALL,120),U,9) I PACK K ^FSCD("CALL","ARP",PACK,CALL)
 .I FIELD="PACK" D  Q
 ..K ^FSCD("CALL","ARP",VALUE,CALL)
 Q
 ;
ARU(OP,FIELD,VALUE,CALL) ; from dd 7100
 N SPEC,STATUS
 I OP="SET" D  Q
 .I FIELD="STATUS" D  Q
 ..I VALUE=3 S SPEC=$P(^FSCD("CALL",CALL,0),U,9) I SPEC S ^FSCD("CALL","ARU",SPEC,CALL)=""
 .I FIELD="SPEC" D  Q
 ..I VALUE S STATUS=$P(^FSCD("CALL",CALL,0),U,2) I STATUS=3 S ^FSCD("CALL","ARU",VALUE,CALL)=""
 I OP="KILL" D  Q
 .I FIELD="STATUS" D  Q
 ..S SPEC=$P(^FSCD("CALL",CALL,0),U,9) I SPEC K ^FSCD("CALL","ARU",SPEC,CALL)
 .I FIELD="SPEC" D  Q
 ..K ^FSCD("CALL","ARU",VALUE,CALL)
 Q
 ;
ARID(OP,FIELD,VALUE,CALL) ; from dd 7100
 N ISC,STATUS
 I OP="SET" D  Q
 .I FIELD="STATUS" D  Q
 ..I VALUE=3 S ISC=$P(^FSCD("CALL",CALL,0),U,20) I ISC S ^FSCD("CALL","ARID",ISC,CALL)=""
 .I FIELD="ISC" D  Q
 ..I VALUE S STATUS=$P(^FSCD("CALL",CALL,0),U,2) I STATUS=3 S ^FSCD("CALL","ARID",VALUE,CALL)=""
 I OP="KILL" D  Q
 .I FIELD="STATUS" D  Q
 ..S ISC=$P(^FSCD("CALL",CALL,0),U,20) I ISC K ^FSCD("CALL","ARID",ISC,CALL)
 .I FIELD="ISC" D  Q
 ..K ^FSCD("CALL","ARID",VALUE,CALL)
 Q
 ;
ARIS(OP,FIELD,VALUE,CALL) ; from dd 7100
 N ISC,STATUS
 I OP="SET" D  Q
 .I FIELD="STATUS" D  Q
 ..I VALUE=3 S ISC=$P(^FSCD("CALL",CALL,0),U,16) I ISC S ^FSCD("CALL","ARIS",ISC,CALL)=""
 .I FIELD="ISC" D  Q
 ..I VALUE S STATUS=$P(^FSCD("CALL",CALL,0),U,2) I STATUS=3 S ^FSCD("CALL","ARIS",VALUE,CALL)=""
 I OP="KILL" D  Q
 .I FIELD="STATUS" D  Q
 ..S ISC=$P(^FSCD("CALL",CALL,0),U,16) I ISC K ^FSCD("CALL","ARIS",ISC,CALL)
 .I FIELD="ISC" D  Q
 ..K ^FSCD("CALL","ARIS",VALUE,CALL)
 Q
 ;
ARISP(OP,FIELD,VALUE,CALL) ; from dd 7100
 N ISC,STATUS
 I OP="SET" D  Q
 .I FIELD="STATUS" D  Q
 ..I VALUE=3 S ISC=$P(^FSCD("CALL",CALL,120),U,10) I ISC S ^FSCD("CALL","ARISP",ISC,CALL)=""
 .I FIELD="ISC" D  Q
 ..I VALUE S STATUS=$P(^FSCD("CALL",CALL,0),U,2) I STATUS=3 S ^FSCD("CALL","ARISP",VALUE,CALL)=""
 I OP="KILL" D  Q
 .I FIELD="STATUS" D  Q
 ..S ISC=$P(^FSCD("CALL",CALL,120),U,10) I ISC K ^FSCD("CALL","ARISP",ISC,CALL)
 .I FIELD="ISC" D  Q
 ..K ^FSCD("CALL","ARISP",VALUE,CALL)
 Q
 ;
ARSC(OP,FIELD,VALUE,CALL) ; from dd 7100
 N SUB,STATUS
 I OP="SET" D  Q
 .I FIELD="STATUS" D  Q
 ..I VALUE=3 S SUB=$P(^FSCD("CALL",CALL,120),U,11) I SUB S ^FSCD("CALL","ARSC",SUB,CALL)=""
 .I FIELD="SUB" D  Q
 ..I VALUE S STATUS=$P(^FSCD("CALL",CALL,0),U,2) I STATUS=3 S ^FSCD("CALL","ARSC",VALUE,CALL)=""
 I OP="KILL" D  Q
 .I FIELD="STATUS" D  Q
 ..S SUB=$P(^FSCD("CALL",CALL,120),U,11) I SUB K ^FSCD("CALL","ARSC",SUB,CALL)
 .I FIELD="SUB" D  Q
 ..K ^FSCD("CALL","ARSC",VALUE,CALL)
 Q
