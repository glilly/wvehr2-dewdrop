XDRMSG ;IHS/OHPRD/JCM - SENDS VARIOUS DUPLICATE MESSAGES;   [ 08/13/92  09:50 AM ]
 ;;7.3;TOOLKIT;;Apr 25, 1995
START ;
 K XMB,XMY,XMTEXT
 D:$D(XDRMSG) @XDRMSG
END D EOJ
 Q
 ;
VERIFY ;
 I $D(XDRM("VERIFY-MSG")) D @XDRM("VERIFY-MSG") G VERIFYX
 I '$D(XDRM("VMAILGRP")) G VERIFYX
 F XDRI=0:0 S XDRI=$O(XDRD("VMAILGRP",XDRI)) Q:'XDRI  S XMY(XDRI)=""
 K XDRI
 S XMB="XDR VERIFIED",XMB(2)=XDRMAIN("FR"),XMB(3)=XDRMAIN("TO")
 I $D(@(XDRGL_XDRMAIN("FR")_",0)")) S XMB(4)=$P(@(XDRGL_XDRMAIN("FR")_",0)"),U,1)
 I $D(@(XDRGL_XDRMAIN("TO")_",0)")) S XMB(5)=$P(@(XDRGL_XDRMAIN("TO")_",0)"),U,1)
 D SEND
VERIFYX Q
 ;
MERGED ;
 I $D(XDRM("MERGE-MSG")) D @XDRM("MERGE-MSG") G MERGEDX
 I '$D(XDRM("MMAILGRP")) G MERGEDX
 F XDRI=0:0 S XDRI=$O(XDRM("MMAILGRP",XDRI)) Q:'XDRI  S XMY(XDRI)=""
 K XDRI
 S XMB="XDR MERGED",XMB(2)=XDRMAIN("FR"),XMB(3)=XDRMAIN("TO")
 I $D(XDRMERR)>9 S XMTEXT="XDRMERR("
 I $D(@(XDRGL_XDRMAIN("FR")_",0)")) S XMB(4)=$P(@(XDRGL_XDRMAIN("FR")_",0)"),U,1)
 I $D(@(XDRGL_XDRMAIN("TO")_",0)")) S XMB(5)=$P(@(XDRGL_XDRMAIN("TO")_",0)"),U,1)
 D SEND
MERGEDX Q
 ;
SEND ;
 I $D(@(XDRGL_XDRMAIN("FR")_",0)"))
 S XMDUZ=.5,XMB(1)=$P(^DIC(XDRFL,0),U,1)
 D ^XMB
 Q
 ;
EOJ ;
 K XMB,XMTEXT,XDRMERR,XMDUZ,XDRMSG
 Q
