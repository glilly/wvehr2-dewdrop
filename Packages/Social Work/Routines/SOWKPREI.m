SOWKPREI ;B'HAM ISC/SAB-PRE-INIT ROUTINE; 12/02/91 15:08 [ 03/27/97  10:04 AM ]
 ;;3.0; Social Work ;**49**;27 Apr 93
 S SOWKPUR=0 I $G(^SOWK(650.1,1,"VER"))'<3 G PUR
 I $O(^SOWK(650,0))]"" F Q=0:0 W !!,"THERE IS DATA IN THE SOCIAL WORK CASE FILE.  DO YOU WANT TO CONTINUE" S %=2 D YN^DICN Q:%  I %Y["?" D YN^SOWKHELP,EXP
 I $G(%)=2!$G(%)=-1 K DIFQ,%,%Y,Q,DTOUT W !,"INSTALLATION TERMINATED !" Q
 S:$G(%)=1 SOWKPUR=1
PUR S SOWKOPT=0 I $D(^DD(650,0)) F Q=0:0 W !!,"DO YOU WANT TO DELETE OLD NAMESPACE (SW) TEMPLATES AND OPTIONS NOW" S %=2 D YN^DICN Q:%  I %Y["?" D YN^SOWKHELP
 S:$G(%)=1 SOWKOPT=1
 I $G(^SOWK(650.1,1,"VER"))'<3 S DIK="^SOWK(651,",DIK(1)="4^AC" D ENALL^DIK F CDC=0:0 S CDC=$O(^SOWK(651,"AC",CDC)) Q:'CDC  S CDC(CDC)=^SOWK(651,CDC,0)
 K DIK
 Q
EXP W !!,"IF 'YES' ALL SOCIAL WORK CASE DATA WILL BE DELETED.",!,"IF 'NO' THE INSTALL WILL TERMINATE, BUT ALL CASES MUST BE CLOSED,",!,"TRANSMITTED TO AUSTIN, AND CASE DATA MUST BE PURGED.",!
 Q
