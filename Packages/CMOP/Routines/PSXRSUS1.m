PSXRSUS1 ;BIR/WPB,BAB,HTW-CMOP Transmission Handler sub routine ;15 Dec 2001
 ;;2.0;CMOP;**41,51**;11 Apr 97
 ;
STOREVAR ; store critical variables
 S X1=DT,X2=+2 D C^%DTC S XXX=X K X1,X2
 S ^XTMP("PSXTVARS "_$J,0)=XXX_U_DT_U_"variables for CMOP transmissions"
 S ZZ=""
 F X="PSXDIVML","PSOSITE","PSOLAP","PSOSYS","PSOPAR","PSXSYS","PSXTRANS","PSXFLAG","PRTDT","PSOINST","PSXDUZ","PSXSITE" S @X=$G(@X)
 F X="PSXCS","PSXDAYS","PSXDTRG","PSOBARS","PSOBAR1","PSOBAR0","PSOPROP","PSXVENDR","PSLION","TPRTDT" S @X=$G(@X)
 S ZZ=""
 F YY="PSXDIVML^1","PSOSITE^2","PSOLAP^3","PSOSYS^4","PSOPAR^5","PSXSYS^6","PSXTRANS^7","PSXFLAG^8","PRTDT^9","PSOINST^10","PSXDUZ^11","PSXSITE^12" D SET^PSXUTL(.ZZ,U,YY)
 S ^XTMP("PSXTVARS "_$J,1)=ZZ
 S ZZ=""
 F YY="PSXCS^1","PSXDAYS^2","PSXDTRG^3","PSOBARS^4","PSOBAR1^5","PSOBAR0^6","PSOPROP^7","PSXVENDR^8","PSLION^9","TPRTDT^10" D SET^PSXUTL(.ZZ,U,YY)
 S ^XTMP("PSXTVARS "_$J,2)=ZZ
 K XXX
 Q
RESETVAR ; retrieve critical variables
 S ZZ=^XTMP("PSXTVARS "_$J,1)
 F YY="PSXDIVML^1","PSOSITE^2","PSOLAP^3","PSOSYS^4","PSOPAR^5","PSXSYS^6","PSXTRANS^7","PSXFLAG^8","PRTDT^9","PSOINST^10","PSXDUZ^11","PSXSITE^12" D SET^PSXUTL(.ZZ,U,YY)
 S ZZ=^XTMP("PSXTVARS "_$J,2)
 F YY="PSXCS^1","PSXDAYS^2","PSXDTRG^3","PSOBARS^4","PSOBAR1^5","PSOBAR0^6","PSOPROP^7","PSXVENDR^8","PSLION^9","TPRTDT^10" D PIECE^PSXUTL(ZZ,U,YY)
 Q
