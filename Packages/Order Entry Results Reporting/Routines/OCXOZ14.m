OCXOZ14 ;SLC/RJS,CLA - Order Check Scan ;AUG 11,2009 at 08:45
        ;;3.0;ORDER ENTRY/RESULTS REPORTING;**32,221,243**;Dec 17,1997;Build 242
        ;;  ;;ORDER CHECK EXPERT version 1.01 released OCT 29,1998
        ;
        ; ***************************************************************
        ; ** Warning: This routine is automatically generated by the   **
        ; ** Rule Compiler (^OCXOCMP) and ANY changes to this routine  **
        ; ** will be lost the next time the rule compiler executes.    **
        ; ***************************************************************
        ;
        Q
        ;
R71R1B  ; Send Order Check, Notication messages and/or Execute code for  Rule #71 'OPIOID MEDICATIONS'  Relation #1 'OPIOID MED ORDER AND DUP OPIOID MEDS'
        ;  Called from R71R1A+12^OCXOZ13.
        ;
        Q:$G(OCXOERR)
        ;
        ;      Local Extrinsic Functions
        ; GETDATA( ---------> GET DATA FROM THE ACTIVE DATA FILE
        ;
        Q:$D(OCXRULE("R71R1B"))
        ;
        N OCXNMSG,OCXCMSG,OCXPORD,OCXFORD,OCXDATA,OCXNUM,OCXDUZ,OCXQUIT,OCXLOGS,OCXLOGD
        I ($G(OCXOSRC)="CPRS ORDER PRESCAN") S OCXCMSG=(+OCXPSD)_"^33^^Duplicate opioid medications: "_$$GETDATA(DFN,"138^139",158) I 1
        E  S OCXCMSG="Duplicate opioid medications: "_$$GETDATA(DFN,"138^139",158)
        S OCXNMSG=""
        ;
        Q:$G(OCXOERR)
        ;
        ; Send Order Check Message
        ;
        S OCXOCMSG($O(OCXOCMSG(999999),-1)+1)=OCXCMSG
        Q
        ;
GETDATA(DFN,OCXL,OCXDFI)        ;     This Local Extrinsic Function returns runtime data
        ;
        N OCXE,VAL,PC S VAL=""
        F PC=1:1:$L(OCXL,U) S OCXE=$P(OCXL,U,PC) I OCXE S VAL=$G(^TMP("OCXCHK",$J,DFN,OCXE,OCXDFI)) Q:$L(VAL)
        Q VAL
        ;
