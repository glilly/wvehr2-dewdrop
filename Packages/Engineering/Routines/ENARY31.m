ENARX31 ;(WIRMFO)/SAW/DH/SAB-EQUIPMENT INV. ARCHIVE ;2.14.97
 ;;7.0;ENGINEERING;**40**;Aug 17, 1993
 S DIFQ=0 W "THIS VERSION OF 'ENARX31' WAS CREATED ON JAN 25,1991",! D VERSION^DINIT I VERSION<17 W "BUT I NEED VERSION 17 OF THE VA FILEMAN!" G Q
 W ?9,"(","AT AEMS Development"," BY VA FileMan V.17.32)",!,"TO SET UP FOR YOU THE FOLLOWING FILE:",! F I=1:1:1 D 1
 G Q:DIFQ I $D(^DD("VERSION")),^("VERSION")'<17 G GO:$O(^("VERSION",17))="" W !,"BUT I'M OBSOLETE!!" G Q
 W !,"FIRST, I'LL FRESHEN UP YOUR VA FILEMAN...." D N^DINIT
GO D ^ENARX32 G Q:'$D(DIFQ) S DIK(0)="B"
 F DIF=1:1:1 S %=$T(IXF+DIF),DIK=$P(%,";",6),N=$P(%,";",3),D=$P(%,";",4)_U_N S:$D(^DIC(+N,0))[0 ^(0)=D S X=$D(@(DIK_"0)")),^(0)=D_U_$S(X#2:$P(^(0),U,3,9),1:U) I '$D(DIFQ(+N)),$P(%,";",5)!'X D IXALL^DIK:$O(^(0))>0 W "."
 S DIFROM=0 D ^ENARX33,^ENARX34
 L  W !,*7,"OK, I'M DONE.",!,"NO"_$P("TE THAT FILE",U,DSEC)_" SECURITY-CODE PROTECTION HAS BEEN MADE" S:$D(DIFROM(0)) ^DIC(9.4,DIFROM(0),"VERSION")=DIFROM G Q^DIFROM0
 ;
1 S X=$T(IXF+I),N=+$P(X,";",3),N(N)=$P(X,";",4),D=$P(X,";",5),S=$P(X,";",6),U="^" W !?3,N,?13,N(N),$P("  (PARTIAL DEFINITION)",U,$P(X,";",7)),$P("  (INCLUDING DATA)",I,D)
 S Z=$S($D(^DIC(N,0))#2:^(0),1:"") I $L($P(Z,N(N),1)) W *7,!,"***BUT YOU'VE ALREADY GOT '",$P(Z,"^",1),"' AS FILE #",N,"!***" S DIFQ=1 Q
 S %=$P(S,"(",1),DW=0 S:$D(@%)#2 DW=@% S @%=DW
 I $L(Z) W *7,!,"NOTE -- YOU ALREADY HAVE '",$P(Z,"^",1),"' FILE" S DIFQ(0)=1
 I D,@("$O("_S_"0))>0") W " WITH DATA",!?9,"WANT MY DATA ADDED IN TO YOURS" S %=1 D YN^DICN S:%=2 DIFQ(N)=1 D OV:D-1&(%=1) I %<1 S DIFQ=1 Q
 W ! Q
OV W !?9,*7,"I WILL **REPLACE** YOUR DATA WITH MINE, OK" D YN^DICN S:%=1 DIFQR(N)=1 Q
Q W *7,!!,"NO UPDATING HAS OCCURRED!"
 ;
IXF ;;ENARX3
 ;;6919.3;EQUIPMENT INV. ARCHIVE;0;^ENAR(6919.3,;
