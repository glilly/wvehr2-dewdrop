QANSITE ;HISC/GJC-CHECK OF SITE PARAMETER DATA ;5/1/92
 ;;2.0;Incident Reporting;;08/07/1992
 ;
 S QAZER0=$G(^QA(740,1,0)) I +QAZER0'>0 S QAERR=1 D ERROR G EXIT
 S QANAME=$G(^DIC(4,+QAZER0,0)) I QANAME']"" S QAERR=2 D ERROR G EXIT
 S QASTNM=$G(^DIC(4,+QAZER0,99)) I QASTNM']"" S QAERR=3 D ERROR G EXIT
 ;S QAEWSMS=$P(QAZER0,U,2) I QAEWSMS']"" S QAERR=4 D ERROR G EXIT
 ;S QAEWSDM=$P(QAZER0,U,3) I QAEWSDM']"" S QAERR=5 D ERROR G EXIT
 S QANQADBS=$P(QAZER0,U,4) I QANQADBS']"" S QAERR=6 D ERROR G EXIT
 S QANQADBD=$P(QAZER0,U,5) I QANQADBD']"" S QAERR=7 D ERROR G EXIT
 ;S QAEWSLMG=$P(QAZER0,U,6) I QAEWSLMG']"" S QAERR=8 D ERROR G EXIT
 S QAINCND=$G(^QA(740,1,"QAN")) I QAINCND']"" S QAERR=9 D ERROR G EXIT
 S QAINCMLG=$P(QAINCND,U) I QAINCMLG']"" S QAERR=10 D ERROR G EXIT
EXIT ;
 K QAZER0,QANAME,QASTNM,QAEWSMS,QAEWSDM,QANQADBS,QANQADBD,QAEWSLMG
 K QAINCND,QAINCMLG,QAERR
 Q
ERROR ;
 W *7,!!,"*** ",$P($T(ERR+QAERR),";;",2)," ***",!!,*7
 S XQUIT=1
 Q
ERR ;;ERROR MESSAGES: REASONS EWS BULLETIN COULD NOT BE SENT
 ;;SITE PARAMETERS FILE MISSING, CONTACT YOUR QA COORDINATOR
 ;;INVALID SITE NAME FOUND IN QA SITE PARAMETERS FILE
 ;;INVALID STATION NUMBER FOUND IN QA SITE PARAMETERS FILE
 ;;EWS MAIL GROUP/SERVER NOT FOUND IN QA SITE PARAMETERS FILE
 ;;EWS DOMAIN NOT FOUND IN QA SITE PARAMETERS FILE
 ;;NQADB MAIL GROUP/SERVER NOT FOUND IN QA SITE PARAMETERS FILE
 ;;NQADB DOMAIN NOT FOUND IN QA SITE PARAMETERS FILE
 ;;EWS LOCAL MAIL GROUP NOT FOUND IN QA SITE PARAMETERS FILE
 ;;INCIDENT REPORTING DATA NOT FOUND IN QA SITE PARAMETERS FILE
 ;;INCIDENT REPORTING MAILGROUP NOT FOUND IN QA SITE PARAMETERS FILE
