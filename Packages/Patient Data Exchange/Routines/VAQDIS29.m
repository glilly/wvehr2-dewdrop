VAQDIS29 ;ALB/JFP,JRP - BUILDS DISPLAY ARRAY FOR (MAS DATA);3JUL91
 ;;1.5;PATIENT DATA EXCHANGE;**13**;NOV 17, 1993
SCR6 ; -- SCREEN 6 (FIRST HALF)
 ;    Calls VAQDIS30 for second half
R0 ; -- HEADER
 D BLANK^VAQDIS20
 S VAQLN=$$REPEAT^VAQUTL1(" ",79)
 S VAQCTR=" -- MILITARY SERVICE -- "
 S X=$$CENTER^VAQDIS20(VAQLN,VAQCTR)
 D TMP,BLANK^VAQDIS20
 K VAQLN,VAQCTR
R1 ;
 S X=$$SETSTR^VALM1("Service Branch","",5,22)
 S X=$$SETSTR^VALM1("Service #",X,25,19)
 S X=$$SETSTR^VALM1("Entered",X,47,12)
 S X=$$SETSTR^VALM1("Separated",X,59,12)
 S X=$$SETSTR^VALM1("Discharge",X,70,9)
 D TMP
R2 ;
 S X=$$SETSTR^VALM1("--------------","",5,22)
 S X=$$SETSTR^VALM1("---------",X,25,19)
 S X=$$SETSTR^VALM1("---------",X,47,12)
 S X=$$SETSTR^VALM1("---------",X,59,12)
 S X=$$SETSTR^VALM1("---------",X,70,9)
 D TMP
R3 ;LAST SERVICE
 S VAQCHK=$G(@XTRCT@("VALUE",2,.325,0))
 S X=$$SETSTR^VALM1(VAQCHK,"",5,22)
 S X=$$SETSTR^VALM1($G(@XTRCT@("VALUE",2,.328,0)),X,25,19)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.326,0)) D SCR6A
 S X=$$SETSTR^VALM1(VAQINF,X,47,12)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.327,0)) D SCR6A
 S X=$$SETSTR^VALM1(VAQINF,X,59,12)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.324,0)) D SCR6B
 S X=$$SETSTR^VALM1(VAQINF,X,70,9)
 D:VAQCHK'="" TMP
R4 ;NEXT TO LAST SERVICE
 S VAQCHK=$G(@XTRCT@("VALUE",2,.3291,0))
 S X=$$SETSTR^VALM1(VAQCHK,"",5,22)
 S X=$$SETSTR^VALM1($G(@XTRCT@("VALUE",2,.3294,0)),X,25,19)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.3292,0)) D SCR6A
 S X=$$SETSTR^VALM1(VAQINF,X,47,12)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.3293,0)) D SCR6A
 S X=$$SETSTR^VALM1(VAQINF,X,59,12)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.329,0)) D SCR6B
 S X=$$SETSTR^VALM1(VAQINF,X,70,9)
 D:VAQCHK'="" TMP
R5 ;THIRD SERVICE
 S VAQCHK=$G(@XTRCT@("VALUE",2,.3296,0))
 S X=$$SETSTR^VALM1(VAQCHK,"",5,22)
 S X=$$SETSTR^VALM1($G(@XTRCT@("VALUE",2,.3299,0)),X,25,19)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.3297,0)) D SCR6A
 S X=$$SETSTR^VALM1(VAQINF,X,47,12)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.3298,0)) D SCR6A
 S X=$$SETSTR^VALM1(VAQINF,X,59,12)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.3295,0)) D SCR6B
 S X=$$SETSTR^VALM1(VAQINF,X,70,9)
 D:VAQCHK'="" TMP
R6 ;
 D BLANK^VAQDIS20
 S X=$$SETSTR^VALM1("POW: "_$G(@XTRCT@("VALUE",2,.525,0)),"",13,12)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.527,0)) D SCR6A
 S X=$$SETSTR^VALM1("From: "_VAQINF,X,25,21)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.528,0)) D SCR6A
 S X=$$SETSTR^VALM1("To: "_VAQINF,X,46,16)
 S VAQINF="War: "_$$SCRWW($G(@XTRCT@("VALUE",2,.526,0)))
 S X=$$SETSTR^VALM1(VAQINF,X,63,17)
 D TMP
R7 ;
 S X=$$SETSTR^VALM1("Combat: "_$G(@XTRCT@("VALUE",2,.5291,0)),"",10,15)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.5293,0)) D SCR6A
 S X=$$SETSTR^VALM1("From: "_VAQINF,X,25,21)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.5294,0)) D SCR6A
 S X=$$SETSTR^VALM1("To: "_VAQINF,X,46,16)
 S VAQINF="Loc: "_$$SCRWW($G(@XTRCT@("VALUE",2,.5292,0)))
 S X=$$SETSTR^VALM1(VAQINF,X,63,17)
 D TMP
R8 ;
 S X=$$SETSTR^VALM1("Vietnam: "_$G(@XTRCT@("VALUE",2,.32101,0)),"",9,16)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.32104,0)) D SCR6A
 S X=$$SETSTR^VALM1("From: "_VAQINF,X,25,21)
 S VAQTMP=$G(@XTRCT@("VALUE",2,.32105,0)) D SCR6A
 S X=$$SETSTR^VALM1("To: "_VAQINF,X,46,33)
 D TMP
MAS6B ;SCREEN 6 (SECOND HALF)
 D SCR6^VAQDIS30
EXIT K VAQCHK,VAQTMP,VAQINF
 Q
TMP ; -- Sets up display array
 S VALMCNT=VALMCNT+1
 S @ROOT@(VALMCNT,0)=$E(X,1,79)
 Q
SCR6A ;DATE CONVERSION
 I VAQTMP="" S VAQINF="" QUIT
 S VAQTMP=$$DATE^VAQUTL99(VAQTMP)
 S VAQINF=$S(VAQTMP'="":$E(VAQTMP,4,5)_"/"_$E(VAQTMP,6,7)_"/"_$E(VAQTMP,2,3),1:VAQTMP)
 Q
SCR6B I VAQTMP["OTHER THAN" S VAQINF="OTHER"
 S VAQINF=$E(VAQTMP,1,12)
 Q
SCRWW(LOC) ;SCREEN FOR WWI & WWII
 S LOC=$G(LOC)
 Q:($E(LOC,1,5)'="WORLD") LOC
 S LOC="WWI"_$E(LOC,12,22)
 Q $TR(LOC," ","")
