ABSVL2 ;VAMC ALTOONA/CTB - MISC VOL LOG-IN SUBROUTINES ;4/4/00  9:37 AM
V ;;4.0;VOLUNTARY TIMEKEEPING;**7,15,18**;JULY 6, 1994
TIME K ABSVX("T"),ABSVX("M")
 N X,Y,%T,ABSVXX,DOW
 D NOW^ABSVQ I DT'=X S DT=X
 D DOW^%DTC S DOW=$S(Y=6:"SAT",Y=0:"SUN",$D(^HOLIDAY(X)):"HOL",1:"WEEKDAY")
 S X=$TR($P(ABSVXX,"@",2),":")
 ;I X<LH,TH>RH S ABSVX("M")=1
 I X>LH QUIT
 I RH>TH QUIT
 I DOW="SAT",+$P(ABSV("PARAM"),"^",14)=0 QUIT
 I DOW="SUN",+$P(ABSV("PARAM"),"^",15)=0 QUIT
 I DOW="HOL",+$P(ABSV("PARAM"),"^",16)=0 QUIT
 S ABSVX("M")=1 Q
ASK S ABSVXA="Do you want to transfer Temporary Log to Daily Time File now",ABSVXB="",%=2 D ^ABSVYN G:%'=1 H^XUS
 S ABSVXA="Are you sure",ABSVXB="",%=1 D ^ABSVYN G:%'=1 H^XUS
 D ^ABSVNIT1
 G H^XUS
 QUIT
LIST ;list volunteers on auto log-in for one day.
 D ^ABSVSITE Q:'%
 S L=0,DIC=503330.1,(FR,TO)="TODAY",DIS(0)="I $P(^ABS(503330.1,D0,0),U,9)=ABSV(""SITE"")",(BY,FLDS)="[ABSV STATION LIST]" D EN1^DIP
 QUIT
