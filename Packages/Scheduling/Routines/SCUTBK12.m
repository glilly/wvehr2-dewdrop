SCUTBK12 ;ALB/SCK - Staff Assignment lookup broker call ; 14 Aug 2002  10:03 AM
 ;;5.3;Scheduling;**41,264**;AUG 13, 1993
 ;
 Q
 ;
STAFFLK(SCDATA,SC) ;
 ;
 N SCUSR,SCVAL,SCREEN,SCINST,SCOK
 D CHK^SCUTBK
 D TMP^SCUTBK
 ;
 S SCINST=$G(SC("USRCOK"),"")
 S SCUSR=$G(SC("USRCLASS"),"")
 S SCVAL=$G(SC("VALUE"),"")
 S SCREEN=$G(SC("SCREEN"),"")
 S SCPC=$G(SC("PC"))
 ;
 IF SCVAL="?"&(SCINST) D  G STAFQ
 . D WHOIS2^USRLM("SCRTN",SCUSR)
 . M SCDATA=SCRTN
 . S SCDATA(0)="[Data]"
 ;
 D URSLKUP^SCMCPR1(.SCDATA,SCUSR,SCVAL,SCREEN,SCINST,SCPC)
 ;
STAFQ ;
 Q
 ;
CHKUSR(SCOK,SCVAL) ;
 S SCOK=$G(^SD(404.91,SCVAL,"PCMM"))
 Q
 ;
GETPC(SCDATA,SC) ;
 ;
 N SCDFN,SCDATE,SCROLE,SCAST
 D CHK^SCUTBK
 D TMP^SCUTBK
 ;
 S SCDFN=$G(SC("DFN"),"")
 S SCDATE=$G(SC("DATE"),DT)
 S SCROLE=$G(SC("ROLE"),1)
 S SCAST=$G(SC("AST"),1)
 ;
 S SCDATA=$$GETPC^SCAPMCU2(SCDFN,SCDATE,SCROLE,SCAST)
 Q
