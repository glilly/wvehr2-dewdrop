RGUTTSK ;CAIRO/DKM - Encapsulates TaskMan API ;04-Sep-1998 11:26;DKM
 ;;2.1;RUN TIME LIBRARY;;Mar 22, 1999
 ;=================================================================
QUEUE(ZTRTN,ZTDESC,ZTDTH,ZTSAVE,ZTIO,ZTUCI,ZTPRI) ;
 N %RGZ,%RGZ1,%RGZ2,ZTKIL,ZTSK,ZTCPU
 S:'$G(ZTDTH) ZTDTH=$H
 S:ZTDTH'?1.N1","1.N ZTDTH=$$FMTH^XLFDT(ZTDTH)
 Q:ZTDTH<0 0
 S:$G(ZTUCI)'="" ZTUCI=$TR(ZTUCI,":",","),ZTCPU=$P(ZTUCI,",",2),ZTUCI=$P(ZTUCI,",")
 S ZTSAVE=$G(ZTSAVE),ZTIO=$G(ZTIO),U="^"
 F %RGZ=1:1:$L(ZTSAVE,U) D
 .S %RGZ1=$P(ZTSAVE,U,%RGZ),%RGZ2=$P(%RGZ1,"=",2,999),%RGZ1=$P(%RGZ1,"=")
 .S:%RGZ1'="" ZTSAVE(%RGZ1)=%RGZ2
 D ^%ZTLOAD
 Q +$G(ZTSK)
