ABSVPPP3 ;EAP ALTOONA  ;9/19/97  4:33 PM
V ;;4.0;VOLUNTARY TIMEKEEPING;**7**;JULY 1994;
DOC ;CALLED BY PROGRAM ABSVPPP2.  USES PARAMETER PASSING
INIT Q:'$D(^TMP("ABSVTMP2"))
 Q:'$D(^TMP("ABSVTMP1"))
 S U7="^" S:'$D(IOSL) IOSL=64
 S ABSVK=0 F ABSVL=1:1 S ABSVK=$O(^TMP("ABSVTMP2",ABSVK)) Q:'ABSVK!(ABSVK="")  S CT=0 S ABSVG=0 F ABSVM=1:1 S ABSVG=$O(^TMP("ABSVTMP2",ABSVK,ABSVG)) D:'ABSVG!(ABSVG="") OUT Q:'ABSVG!(ABSVG="")  I $D(^TMP("ABSVTMP2",ABSVK,ABSVG)) S CT=CT+1 D
 .S ABSVZ=^TMP("ABSVTMP2",ABSVK,ABSVG) D:ABSVG=1 HDR D:LC=IOSL HDR W:ABSVG>1 !,?9,ABSVZ S LC=LC+1 I ABSVG>2 I $D(^TMP("ABSVTMP1",ABSVK,ABSVG)) W ?69,"| ",^TMP("ABSVTMP1",ABSVK,ABSVG)
END ;;;;;;;;;;;;;;;
 K ABSVY7,U7,PAGE,ABSVL,ABSVK,CT,ABSVG,ABSVM,ABSVZ,ABSVP,ABSVF,ABSVE,LC,ABSVLINE
 Q
HDR ;;;;;;;;;;;;;;;;
 I ABSVG=1 S HOLD=ABSVZ
 S LC=0 K ABSVLINE S $P(ABSVLINE,"=",IOM)=""
 W #,!,ABSVLINE
 I ABSVG=1 S B1=$P(HOLD,U7,1) S B2=$P(HOLD,U7,2) S B3=$P(HOLD,U7,3)
 I ABSVG>1 S B1=$P(HOLD,U7,1),B2="** CONTINUATION **",B3=""
 W !,?23,B1,?59,B2,?71,B3,!,ABSVLINE,!
 S LC=LC+5
 Q
OUT ;;IF RIGHT HAND COLUMN IS GREATER THAN LEFT HAND COL, PRINT IT!
 S ABSVF=0 F ABSVE=1:1 S ABSVF=$O(^TMP("ABSVTMP1",ABSVK,ABSVF)) Q:'ABSVF!(ABSVF="")  I $D(^TMP("ABSVTMP1",ABSVK,ABSVF)) I ABSVF>CT W !,?69,"| ",^TMP("ABSVTMP1",ABSVK,ABSVF)
 Q
DATEONLY ;;
 S:ABSVY7 ABSVY7=$P($$FULLDAT^ABSVU2(ABSVY7),"@",1)
 QUIT
CONVERT1 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 S:ABSVY7 ABSVY7=$$FULLDAT^ABSVU2(ABSVY7) QUIT
 QUIT
