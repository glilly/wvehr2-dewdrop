TIUPRF3 ; SLC/JMH - More Modules for Patient Record Flags ; 4/18/05
 ;;1.0;TEXT INTEGRATION UTILITIES;**184**;Jun 20, 1997
 ;
LKDETAIL(TIUDA,TIUL) ; Add note's PRF LINK info to Detail Disp array TIUL
 N TIUTTL,FLAGNM,LINE,TIULINK
 N HASFLAG
 S TIUL=TIUL+1 D BLANK^TIUSRV(TIUL) S TIUL=TIUL+1
 D SET^TIUSRV(TIUL,1,"Linked PRF Action ",$G(IORVON),$G(IORVOFF))
 S TIUTTL=$P(^TIU(8925,TIUDA,0),U),HASFLAG=1
 S LINE="Flag:  "
 S FLAGNM=$$FNDFLAG^TIUPRFL(TIUTTL)
 I 'FLAGNM S FLAGNM="This PRF Note Title is not associated with a Flag.",HASFLAG=0
 I HASFLAG S FLAGNM=$P(FLAGNM,U,2)
 S LINE=LINE_FLAGNM
 S TIUL=TIUL+1
 D SET^TIUSRV(TIUL,13,"Flag: "_FLAGNM) Q:'HASFLAG
 S LINE="Flag Action: "
 S TIULINK=$$GETLINK^DGPFAPI1(TIUDA)
 I 'TIULINK S LINE=LINE_"Note not linked." D SET^TIUSRV(TIUL+1,6,LINE) S TIUL=TIUL+1 Q
 S LINE=LINE_$$CFLDACT^TIUPRFL(TIUDA)
 D SET^TIUSRV(TIUL+1,6,LINE)
 S TIUL=TIUL+1
 Q
