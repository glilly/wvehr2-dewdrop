LABCX4I ;SLC/DLG/FHS - BECKMAN BIDIRECTIONAL DIRECT CONNECT SETUP ;9/21/90
 ;;5.2;AUTOMATED LAB INSTRUMENTS;;Sep 27, 1994
EN ;
 S IOP=IOP_";255",%ZIS="" D ^%ZIS G:POP H^XUS U IO X ^%ZOSF("TYPE-AHEAD"),^%ZOSF("LABOFF") S X=0 X ^%ZOSF("RM")
 C:IO(0)'=IO IO(0) S X="TRAP^"_LANM,@^%ZOSF("TRAP"),DUZ=.5 R X:1,X:1 D SET,^LASET
 S I=0 F J=0:0 S I=$O(TC(I)) Q:I<1  S:$D(TC(I,4))#2 TS(TC(I,4))=I
 S PAR=$S($D(^LAB(62.4,T,.5))#2:^(.5),1:""),OUT="",BASE=0,TOUT=15,U="^",^LA(T,"P")="",^("P1")=3,^("P2")=3,^("P3")=0,DEB="D"_T,LB=1,LBO=2,ETX=3,EOT=4,ENQ=5,ACK=6,NAK=21
 G @("LA2^"_LANM)
SET S:'$D(^LA(T,"I"))#2 ^LA(T,"I")=0,^("I",0)=0
SETO S:'$D(^LA(T,"O"))#2 ^LA(T,"O")=0,^("O",0)=0 Q
 Q
