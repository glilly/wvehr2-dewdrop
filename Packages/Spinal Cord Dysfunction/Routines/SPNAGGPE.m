SPNAGGPE ;SD/CM- PRINT AGGREGATE ANN EVAL OUTCOMES; 2-21-2003
 ;;2.0;Spinal Cord Dysfunction;**21,24**;01/02/97
 ;
PRINT ;
 S U="^"
 W !!
 S SPNPD0=0 F  S SPNPD0=$O(^SPNL(154.1,"B",SPNPD0)) Q:'+SPNPD0  D OIEN^SPNAGGE
 W !,?20,"ANNUAL EVALUATION Outcomes Report"
 W !,?24,"Date of Report: ",$$FMTE^XLFDT($$NOW^XLFDT,"5DZP")
 W !,?11,"Based on Observations from ",$$FMTE^XLFDT(BDATE,"5DZP")," to ",$$FMTE^XLFDT(EDATE,"5DZP"),!!
 S LINE="-" F I=1:1:80 W LINE
 W !,?SPNT1,"HI TETRA",?SPNT2,"LO TETRA",?SPNT3,"PARA",?SPNT4,"ASIA D",?SPNT5,"ALL",!
 W !,"# and % of Patients",?SPNT1,SPNSEVC," (",$S(+SPNDIAGC:$J(SPNSEVC/SPNDIAGC*100,2,0),1:0),"%)",?SPNT2,SPNMODC," (",$S(+SPNDIAGC:$J(SPNMODC/SPNDIAGC*100,2,0),1:0),"%)"
 W ?SPNT3,SPNPARC," (",$S(+SPNDIAGC:$J(SPNPARC/SPNDIAGC*100,2,0),1:0),"%)",?SPNT4,SPNLOWC," (",$S(+SPNDIAGC:$J(SPNLOWC/SPNDIAGC*100,2,0),1:0),"%)",?SPNT5,SPNDIAGC," (100%)"
 W !,"Age (yrs)",?SPNT1,$S(+SPNSEVC:$J(SPNAGES/SPNSEVC,3,1),1:"N/A"),?SPNT2,$S(+SPNMODC:$J(SPNAGEM/SPNMODC,3,1),1:"N/A"),?SPNT3,$S(+SPNPARC:$J(SPNAGEP/SPNPARC,3,1),1:"N/A"),?SPNT4,$S(+SPNLOWC:$J(SPNAGEL/SPNLOWC,3,1),1:"N/A")
 W ?SPNT5,$S(SPNDIAGC>0:$J(SPNAGES+SPNAGEM+SPNAGEP+SPNAGEL/SPNDIAGC,3,1),1:"N/A")
 W !,"Age Range",?SPNT1,MINAGES,"-",MAXAGES,?SPNT2,MINAGEM,"-",MAXAGEM,?SPNT3,MINAGEP,"-",MAXAGEP,?SPNT4,MINAGEL,"-",MAXAGEL,?SPNT5,AGEL,"-",AGEH
 W !,"Gender (% Male pts)",?SPNT1,$S(+SPNSEVC:$J(SPNSEXS/SPNSEVC*100,2,0)_"%",1:"N/A"),?SPNT2,$S(+SPNMODC:$J(SPNSEXM/SPNMODC*100,2,0)_"%",1:"N/A"),?SPNT3,$S(+SPNPARC:$J(SPNSEXP/SPNPARC*100,2,0)_"%",1:"N/A")
 W ?SPNT4,$S(+SPNLOWC:$J(SPNSEXL/SPNLOWC*100,2,0)_"%",1:"N/A")
 W ?SPNT5,$S(+SPNDIAGC:$J(SPNSEXS+SPNSEXM+SPNSEXP+SPNSEXL/SPNDIAGC*100,2,0)_"%",1:"N/A")
 W !,"Total FIM Score",?SPNT1,$S(+TFCS:TFS/TFCS,1:"N/A"),?SPNT2,$S(+TFCM:TFM/TFCM,1:"N/A"),?SPNT3,$S(+TFCP:TFP/TFCP,1:"N/A"),?SPNT4,$S(+TFCL:TFL/TFCL,1:"N/A")
 W ?SPNT5,$S(TFCS+TFCM+TFCP+TFCL>0:$J(TFS+TFM+TFP+TFL/(TFCS+TFCM+TFCP+TFCL),3,1),1:"N/A")
 W !,"Motor FIM Score",?SPNT1,$S(+MFCS:MFS/MFCS,1:"N/A"),?SPNT2,$S(+MFCM:MFM/MFCM,1:"N/A"),?SPNT3,$S(+MFCP:MFP/MFCP,1:"N/A"),?SPNT4,$S(+MFCL:MFL/MFCL,1:"N/A")
 W ?SPNT5,$S(MFCS+MFCM+MFCP+MFCL>0:$J(MFS+MFM+MFP+MFL/(MFCS+MFCM+MFCP+MFCL),3,1),1:"N/A")
 W !,"Cognitive FIM Score",?SPNT1,$S(+CFCS:CFS/CFCS,1:"N/A"),?SPNT2,$S(+CFCM:CFM/CFCM,1:"N/A"),?SPNT3,$S(+CFCP:CFP/CFCP,1:"N/A"),?SPNT4,$S(+CFCL:CFL/CFCL,1:"N/A")
 W ?SPNT5,$S(CFCS+CFCM+CFCP+CFCL>0:$J(CFS+CFM+CFP+CFL/(CFCS+CFCM+CFCP+CFCL),3,1),1:"N/A")
 W !,"CHART Physical Indep",?SPNT1,$S(+CPICS:CPIS/CPICS,1:"N/A"),?SPNT2,$S(+CPICM:CPIM/CPICM,1:"N/A"),?SPNT3,$S(+CPICP:CPIP/CPICP,1:"N/A"),?SPNT4,$S(+CPICL:CPIL/CPICL,1:"N/A")
 W ?SPNT5,$S(CPICS+CPICM+CPICP+CPICL>0:$J(CPIS+CPIM+CPIP+CPIL/(CPICS+CPICM+CPICP+CPICL),3,1),1:"N/A")
 W !,"CHART Cognitive Indep",?SPNT1,$S(+CCICS:CCIS/CCICS,1:"N/A"),?SPNT2,$S(+CCICM:CCIM/CCICM,1:"N/A"),?SPNT3,$S(+CCICP:CCIP/CCICP,1:"N/A"),?SPNT4,$S(+CCICL:CCIL/CCICL,1:"N/A")
 W ?SPNT5,$S(CCICS+CCICM+CCICP+CCICL>0:$J(CCIS+CCIM+CCIP+CCIL/(CCICS+CCICM+CCICP+CCICL),3,1),1:"N/A")
 W !,"CHART Mobility",?SPNT1,$S(+CMCS:CMS/CMCS,1:"N/A"),?SPNT2,$S(+CMCM:CMM/CMCM,1:"N/A"),?SPNT3,$S(+CMCP:CMP/CMCP,1:"N/A"),?SPNT4,$S(+CMCL:CML/CMCL,1:"N/A")
 W ?SPNT5,$S(CMCS+CMCM+CMCP+CMCL>0:$J(CMS+CMM+CMP+CML/(CMCS+CMCM+CMCP+CMCL),3,1),1:"N/A")
 W !,"CHART Occupation",?SPNT1,$S(+COCS:COS/COCS,1:"N/A"),?SPNT2,$S(+CMCM:COM/CMCM,1:"N/A"),?SPNT3,$S(+COCP:COP/COCP,1:"N/A"),?SPNT4,$S(+COCL:COL/COCL,1:"N/A")
 W ?SPNT5,$S(COCS+COCM+COCP+COCL>0:$J(COS+COM+COP+COL/(COCS+COCM+COCP+COCL),3,1),1:"N/A")
 W !,"CHART Social Interaction",?SPNT1,$S(+CSICS:CSIS/CSICS,1:"N/A"),?SPNT2,$S(+CSICM:CSIM/CSICM,1:"N/A"),?SPNT3,$S(+CSICP:CSIP/CSICP,1:"N/A"),?SPNT4,$S(+CSICL:CSIL/CSICL,1:"N/A")
 W ?SPNT5,$S(CSICS+CSICM+CSICP+CSICL>0:$J(CSIS+CSIM+CSIP+CSIL/(CSICS+CSICM+CSICP+CSICL),3,1),1:"N/A")
 W !,"CHART Economic",?SPNT1,$S(+CECS:CES/CECS,1:"N/A"),?SPNT2,$S(+CECM:CEM/CECM,1:"N/A"),?SPNT3,$S(+CECP:CEP/CECP,1:"N/A"),?SPNT4,$S(+CECL:CEL/CECL,1:"N/A")
 W ?SPNT5,$S(CECS+CECM+CECP+CECL>0:$J(CES+CEM+CEP+CEL/(CECS+CECM+CECP+CECL),3,1),1:"N/A")
 W !,"Diener SWLS",?SPNT1,$S(+SLCS:SLSS/SLCS,1:"N/A"),?SPNT2,$S(+SLCM:SLSM/SLCM,1:"N/A"),?SPNT3,$S(+SLCP:SLSP/SLCP,1:"N/A"),?SPNT4,$S(+SLCL:SLSL/SLCL,1:"N/A")
 W ?SPNT5,$S(SLCS+SLCM+SLCP+SLCL>0:$J(SLSS+SLSM+SLSP+SLSL/(SLCS+SLCM+SLCP+SLCL),3,1),1:"N/A")
 Q
