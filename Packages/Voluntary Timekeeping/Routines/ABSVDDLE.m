ABSVDDLE ;EAP ALTOONA VOLUNTARY PACKAGE  ; 26 Sep 2001  2:04 PM
V ;;4.0;VOLUNTARY TIMEKEEPING;**25,26**;JULY 6, 1994
 ;EDIT EXISTING DONATIONS LETTER FORMAT
START S DIC="^ABS(503341," S DIC(0)="AEMNZQ" D ^DIC G:Y<0 END
EDIT S DIE=DIC,DA=+Y,DR="[ABSV DON LETTER EDIT]" D ^DIE I $D(Y) G END
 D YESNO I %=1 G START
END ;;;;;;;;;;;;;;
 K DIC,DIC(0),DR,DIE,%
 Q
YESNO ;;YES/NO PROCESSOR UTILITY
 ;;OPTIONAL VARIABLE %A WHICH EQUALS QUESTION TEXT
 ;;RETURNS % : 1=YES, 2=NO, 3=^, 4=ANYTHING ELSE ASK AGAIN.
ASKIT S:'$D(%A) %A="Do you want to EDIT another one"
 S %B="Enter 'Yes' or 'No'.  Enter '^' to Quit."
 W !,%A_"? (Y/N) // " R ANS:$S($D(DTIME):DTIME,1:300) I (ANS["?")!(ANS="") W *7,!,%B G ASKIT
 I ANS["^" S %=3 Q
 S ANS=$E(ANS,1) S %=$S(ANS="Y":1,ANS="y":1,ANS="N":2,ANS="n":2,1:4) I ANS=4 G ASKIT
 K ANS,%A,%B Q
