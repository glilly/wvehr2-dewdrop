GMRVALL0 ;HIRMFO/YH-ENTER/EDIT V/M AND OTHER MEASUREMENTS ;1/21/97
 ;;4.0;Vitals/Measurements;**1**;Apr 25, 1997
EN1 ;SELECT V/M AND OTHER MEASUREMENTS TO ENTER/EDIT
 S (GMRTMP,GMROUT)=0
LIST W ! S GNNX=0 D LISTOP^GMRVALL1
 S GNI="" W !!,"Select from 1 to ",GNNX," (enter 1,3-5 etc.) or ^ to exit: " R GNI:DTIME S:'$T!(GNI["^")!(GNI="") GMROUT=1 G:GMROUT Q
 I $L(GNI)>20 G LIST
 I (GNI["?") D
 .W @IOF,"The user would be allowed to select individual items, a range,",!,"or a multiple items, separated by commas.",!
 G:GNI["?" LIST D VALIDAT^GMRVALL1 I '$D(GSEL)!GMROUT(1) W $C(7),"  ??" G LIST
 S GMRENTY=9,GMRSTR="" F I=1:1:10 I $D(GSEL(I)) S GMRSTR=GMRSTR_$P(GNNX(I),"^",2)_";"
 I $D(GNUROP) D Q Q
 I '$D(GNUROP) D EN2^GMRVED0
Q K GMRTMP,GLINE,GMRW,GNI,GNNX,GNUROP,GNURX,GSEL Q
V1 ;
 W !!,$S(GMRNAM'="  BLANK":GMRNAM,1:DFN),?$X+10,$S(GMRRMBD'="  BLANK":GMRRMBD,1:""),"  OK? YES// " R GMRX:DTIME
 I GMRX="^"!('$T) S GMROUT=1 Q
 I ((GMRX="")!($E(GMRX,1)="Y")) K GMRTO S GDT=GMRVIDT D EN1^GMRVADM G:GMROUT&'$D(GMRTO) V2 D EDIT S (GMRDT0,GMRVIDT)=GMRTM G:GMROUT&'$D(GMRTO) V2 Q
 G:GMRX?1"N".E V2
 W !,"ANSWER YES OR NO" G V1
V2 ;
 W !!,"Do you wish to stop looping through names? YES//" R GMRX:DTIME
 I (('$T)!(GMRX="")!($E(GMRX,1)="Y")!(GMRX="^")) S GMROUT=1 Q
 I GMRX?1"N".E S GMROUT=0 Q
 W !,"ANSWER YES OR NO" G V2
 Q
EDIT ;
 S DA=DFN I GVM S GMRSTR=GMRSTR(1),GMRSITE("BP")="" D EN2^GMRVED3 S GMROUT=0 K GMROV,GMRP,GMRPRMT,GMRTYPE,GLAST,GMRHELP,GMRDAT,GMRDATE,GMRINPTR,GMRLEN,GMRQUAL,GMRSCR,GMRSITE,GMRVITY,GMRVIT,GMRX,GCT,GDT S DA=DFN D KVAR^VADPT
 Q
