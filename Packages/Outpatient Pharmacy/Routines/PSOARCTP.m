PSOARCTP ;BHAM ISC/LGH - WRITE PSRX INFO TO TAPE ; 08/19/92
 ;;7.0;OUTPATIENT PHARMACY;;DEC 1997
EN ;
TAPE D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W RX(RX0,0)
 I $D(RX(RX0,1,0)) D
 .F X=0:0 S X=$O(RX(RX0,1,X)) Q:'X  I $G(RX(RX0,1,X,0))]"" D TAPE1
 I $D(RX(RX0,4,0)) D
 .F X=0:0 S X=$O(RX(RX0,4,X)) Q:'X  I $G(RX(RX0,4,X,0))]"" D TAPE4
 I $D(RX(RX0,5,0)) D
 .F X=0:0 S X=$O(RX(RX0,5,X)) Q:'X  I $G(RX(RX0,5,X,0))]"" D TAPE5
TAPE2 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W RX(RX0,2)
 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W RX(RX0,3)
ANODE I $D(RX(RX0,"A",0)) F X=0:0 S X=$O(RX(RX0,"A",X)) Q:'X  D ANODE1
LNODE I $D(RX(RX0,"L",0)) F X=0:0 S X=$O(RX(RX0,"L",X)) Q:'X  D LNODE1
PNODE I $D(RX(RX0,"P",0)) F X=0:0 S X=$O(RX(RX0,"P",X)) Q:'X  D PNODE1
IBNODE I $D(RX(RX0,"IB")) D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W "IB$$"_RX(RX0,"IB")
CNODE I $D(RX(RX0,"C")) D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W "C$$"_RX(RX0,"C")
DNODE I $D(RX(RX0,"D")) D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W "D$$"_RX(RX0,"D")
SNODE I $D(RX(RX0,"SAND")) D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W "S$$"_RX(RX0,"SAND")
 K RX(RX0)
 Q
 ;
 ;
PSOAT U PSOAT S (PSRST,PSOAEOT)=0 X ^%ZOSF("EOT") I Y D EOT1 S PSOAEOT=1
 U PSOAT Q
EOT1 U IO(0) W !!,?5,"** End of tape detected **",!,"After current tape rewinds, mount next tape" U PSOAT W @%MT("REW")
READ U IO(0) R !,?5,"Press RETURN to continue",X:DTIME I '$T G READ
 W !!,"Recording information"  S PSOATNM=PSOATNM+1
 Q
TAPE1 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W 1_","_X_"$$"_RX(RX0,1,X,0) Q
TAPE4 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W 4_","_X_"$$"_RX(RX0,4,X,0) Q
TAPE5 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W 5_","_X_"$$"_RX(RX0,5,X,0) Q
ANODE1 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W "A"_","_X_"$$"_RX(RX0,"A",X,0) Q
LNODE1 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W "L"_","_X_"$$"_RX(RX0,"L",X,0) Q
PNODE1 D PSOAT D:PSOAEOT TAPE1^PSOARCS2 G:PSOAEOT TAPE W "P"_","_X_"$$"_RX(RX0,"P",X,0) Q
