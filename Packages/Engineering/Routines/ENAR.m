ENAR ;(WIRMFO)/JED/SAB-ARCHIVE DRIVER ;2.26.97
 ;;7.0;ENGINEERING;**40**;Aug 17, 1993
 Q
G ;GATHER RECORDS
 D SFT G:ENERR'=0 MSG D G^ENAR1 G OUT
A ;ARCHIVE & VERIFY RECORDS
 D SFT G:ENERR'=0 MSG D A^ENAR1 G OUT
D ;DELETE ARCHIVE GLOBAL
 D SFT G:ENERR'=0 MSG D D^ENAR1 G OUT
R ;RECALL ARCHIVE INFORMATION
 D SFT G:ENERR'=0 MSG D R^ENAR1 G OUT
L ;REVIEW ACTIVITY LOG
 D L^ENARL Q
S ;SEARCH FOR EQUIPMENT ARCHIVE
 D S^ENARS Q
 ;
OUT K ENERR,ENGBL,ENR,ENRT,I,J,K,S,X
 Q
 ;
SFT ;SELECT FILE TYPE
 S ENERR=0 K ENRT,ENGBL
 S DIR(0)="SO^1:WORK ORDERS;2:2162 ACCIDENT REPORTS;3:EQUIPMENT INVENTORY"
 S DIR("A")="Select AVAILABLE FILE"
 D ^DIR K DIR S:'Y!$D(DIRUT) ENERR="FILE TYPE SELECT"
 I ENERR=0 S ENRT=+Y,ENGBL="6919."_ENRT
 Q
 ;
MSG W @IOF,!!,*7,"Process terminated: ",ENERR S ENERR=0
 K ENR,ENRT,Y
MSG1 W !,"<cr> to continue" R ENR:DTIME
 Q
 ;
 ;ENAR
