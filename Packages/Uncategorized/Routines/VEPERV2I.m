VEPERV2I ; SLC/PKR - Version 2.0 init routine. ; 7/7/05 10:59am
 ;;2.0;CLINICAL REMINDERS;;Feb 04, 2005
 ;Reminder Exchange install.  VOE 7/6/05
 Q
 ;
 ;===============================================================
ARRAY(MODE,ARRAY) ;List of exchange entries used by delete and install
 ;
 S ARRAY(1,1)="VOE DOQ-IT PC10 REMINDER" I MODE S ARRAY(1,2)="07/06/2005@15:43:22"
 S ARRAY(2,1)="VOE DOQ-IT PC11 REMINDER" I MODE S ARRAY(2,2)="07/06/2005@15:38:22"
 S ARRAY(3,1)="VOE DOQ-IT PC12 REMINDER" I MODE S ARRAY(3,2)="07/06/2005@15:38:37"
 S ARRAY(4,1)="VOE DOQ-IT PC5 REMINDER" I MODE S ARRAY(4,2)="07/06/2005@17:21:10"
 S ARRAY(5,1)="VOE DOQ-IT PC6 REMINDER" I MODE S ARRAY(5,2)="07/06/2005@17:21:24"
 S ARRAY(6,1)="VOE DOQ-IT PC7 REMINDER" I MODE S ARRAY(6,2)="07/06/2005@17:21:42"
 S ARRAY(7,1)="VOE DOQ-IT PC8 REMINDER" I MODE S ARRAY(7,2)="07/06/2005@17:21:59"
 S ARRAY(8,1)="VOE DOQ-IT PC9 REMINDER" I MODE S ARRAY(8,2)="07/06/2005@17:22:18"
 S ARRAY(9,1)="VOE DOQIT CAD REMINDER" I MODE S ARRAY(9,2)="07/06/2005@17:39:49"
 S ARRAY(10,1)="VOE DOQIT CAD1 REMINDER" I MODE S ARRAY(10,2)="07/06/2005@17:40:09"
 S ARRAY(11,1)="VOE DOQIT CAD2 REMINDER" I MODE S ARRAY(11,2)="07/06/2005@17:40:41"
 S ARRAY(12,1)="VOE DOQIT CAD3 REMINDER" I MODE S ARRAY(12,2)="07/06/2005@17:42:46"
 S ARRAY(13,1)="VOE DOQIT CAD4 REMINDER" I MODE S ARRAY(13,2)="07/06/2005@17:43:18"
 S ARRAY(14,1)="VOE DOQIT CAD5 REMINDER" I MODE S ARRAY(14,2)="07/06/2005@17:43:55"
 S ARRAY(15,1)="VOE DOQIT CAD6 REMINDER" I MODE S ARRAY(15,2)="07/06/2005@17:47:14"
 S ARRAY(16,1)="VOE DOQIT CAD7 REMINDER" I MODE S ARRAY(16,2)="07/06/2005@17:47:46"
 S ARRAY(17,1)="VOE DOQIT DM REMINDER" I MODE S ARRAY(17,2)="07/06/2005@17:49:01"
 S ARRAY(18,1)="VOE DOQIT DM1 REMINDER" I MODE S ARRAY(18,2)="07/06/2005@17:49:39"
 S ARRAY(19,1)="VOE DOQIT DM2 REMINDER" I MODE S ARRAY(19,2)="07/06/2005@17:50:16"
 S ARRAY(20,1)="VOE DOQIT DM3 REMINDER" I MODE S ARRAY(20,2)="07/06/2005@17:51:26"
 S ARRAY(21,1)="VOE DOQIT DM4 REMINDER" I MODE S ARRAY(21,2)="07/06/2005@17:51:49"
 S ARRAY(22,1)="VOE DOQIT DM5 REMINDER" I MODE S ARRAY(22,2)="07/06/2005@17:54:02"
 S ARRAY(23,1)="VOE DOQIT DM6 REMINDER" I MODE S ARRAY(23,2)="07/06/2005@17:54:49"
 S ARRAY(24,1)="VOE DOQIT DM7 REMINDER" I MODE S ARRAY(24,2)="07/06/2005@17:55:26"
 S ARRAY(25,1)="VOE DOQIT DM8 REMINDER" I MODE S ARRAY(25,2)="07/06/2005@17:56:11"
 S ARRAY(26,1)="VOE DOQIT HF REMINDER" I MODE S ARRAY(26,2)="07/06/2005@17:56:50"
 S ARRAY(27,1)="VOE DOQIT HF1 REMINDER" I MODE S ARRAY(27,2)="07/06/2005@17:57:29"
 S ARRAY(28,1)="VOE DOQIT HF2 REMINDER" I MODE S ARRAY(28,2)="07/06/2005@17:58:16"
 S ARRAY(29,1)="VOE DOQIT HF3 REMINDER" I MODE S ARRAY(29,2)="07/06/2005@17:58:57"
 S ARRAY(30,1)="VOE DOQIT HF4 REMINDER" I MODE S ARRAY(30,2)="07/06/2005@17:59:41"
 S ARRAY(31,1)="VOE DOQIT HF5 REMINDER" I MODE S ARRAY(31,2)="07/06/2005@18:00:30"
 S ARRAY(32,1)="VOE DOQIT HF6 REMINDER" I MODE S ARRAY(32,2)="07/06/2005@18:01:40"
 S ARRAY(33,1)="VOE DOQIT HF7 REMINDER" I MODE S ARRAY(33,2)="07/06/2005@18:02:24"
 S ARRAY(34,1)="VOE DOQIT HF8 REMINDER" I MODE S ARRAY(34,2)="07/06/2005@18:02:53"
 S ARRAY(35,1)="VOE DOQIT HTN REMINDER" I MODE S ARRAY(35,2)="07/06/2005@18:03:41"
 S ARRAY(36,1)="VOE DOQIT HTN1 REMINDER" I MODE S ARRAY(36,2)="07/06/2005@18:04:12"
 S ARRAY(37,1)="VOE DOQIT HTN2 REMINDER" I MODE S ARRAY(37,2)="07/06/2005@18:04:43"
 S ARRAY(38,1)="VOE DOQIT HTN3 REMINDER" I MODE S ARRAY(38,2)="07/06/2005@18:06:14"
 S ARRAY(39,1)="VOE DOQIT PC REMINDER" I MODE S ARRAY(39,2)="07/06/2005@18:07:12"
 S ARRAY(40,1)="VOE DOQIT PC1 REMINDER" I MODE S ARRAY(40,2)="07/06/2005@18:07:26"
 S ARRAY(41,1)="VOE PED DTP 1" I MODE S ARRAY(41,2)="07/07/2005@10:57:57"
 S ARRAY(42,1)="VOE PED DTP 2" I MODE S ARRAY(42,2)="07/07/2005@10:54:05"
 S ARRAY(43,1)="VOE PED DTP 3" I MODE S ARRAY(43,2)="07/07/2005@10:54:54"
 S ARRAY(44,1)="VOE PED DTP 4" I MODE S ARRAY(44,2)="07/07/2005@10:55:09"
 S ARRAY(45,1)="VOE PED DTP 5" I MODE S ARRAY(45,2)="07/07/2005@10:55:22"
 S ARRAY(46,1)="VOE PED DTP CHECK" I MODE S ARRAY(46,2)="07/06/2005@18:10:32"
 S ARRAY(47,1)="VOE PED HEPB 1" I MODE S ARRAY(47,2)="07/06/2005@18:11:36"
 S ARRAY(48,1)="VOE PED HEPB 2" I MODE S ARRAY(48,2)="07/06/2005@18:11:49"
 S ARRAY(49,1)="VOE PED HEPB 3" I MODE S ARRAY(49,2)="07/06/2005@18:12:02"
 S ARRAY(50,1)="VOE PED HEPB 4" I MODE S ARRAY(50,2)="07/06/2005@18:12:21"
 S ARRAY(51,1)="VOE PED HEPB OVERDUE" I MODE S ARRAY(51,2)="07/06/2005@18:12:40"
 S ARRAY(52,1)="VOE PED HIB 1" I MODE S ARRAY(52,2)="07/06/2005@18:12:59"
 S ARRAY(53,1)="VOE PED HIB 2" I MODE S ARRAY(53,2)="07/06/2005@18:13:13"
 S ARRAY(54,1)="VOE PED HIB 3" I MODE S ARRAY(54,2)="07/06/2005@18:13:32"
 S ARRAY(55,1)="VOE PED HIB 4" I MODE S ARRAY(55,2)="07/06/2005@18:13:46"
 S ARRAY(56,1)="VOE PED IPV #1" I MODE S ARRAY(56,2)="07/06/2005@18:14:06"
 S ARRAY(57,1)="VOE PED IPV #2" I MODE S ARRAY(57,2)="07/06/2005@18:14:19"
 S ARRAY(58,1)="VOE PED IPV #3" I MODE S ARRAY(58,2)="07/06/2005@18:14:31"
 S ARRAY(59,1)="VOE PED IPV #4" I MODE S ARRAY(59,2)="07/06/2005@18:14:44"
 S ARRAY(60,1)="VOE PED MUMPS,MEASLES,RUBELLA" I MODE S ARRAY(60,2)="07/06/2005@18:15:03"
 S ARRAY(61,1)="VOE PED MUMPS,MEASLES,RUBELLA >= 4 YEARS" I MODE S ARRAY(61,2)="07/06/2005@18:16:05"
 S ARRAY(62,1)="VOE PED MUMPS,MEASLES,RUBELLA FOLLOW UP" I MODE S ARRAY(62,2)="07/06/2005@18:16:27"
 S ARRAY(63,1)="VOE PED PCV 1" I MODE S ARRAY(63,2)="07/06/2005@18:16:53"
 S ARRAY(64,1)="VOE PED PCV 2" I MODE S ARRAY(64,2)="07/06/2005@18:17:08"
 S ARRAY(65,1)="VOE PED PCV 3" I MODE S ARRAY(65,2)="07/06/2005@18:17:22"
 S ARRAY(66,1)="VOE PED PCV 4" I MODE S ARRAY(66,2)="07/06/2005@18:17:34"
 S ARRAY(67,1)="VOE PED PCV CHECK" I MODE S ARRAY(67,2)="07/06/2005@18:17:47"
 S ARRAY(68,1)="VOE PED VAC INFLUENZA" I MODE S ARRAY(68,2)="07/06/2005@18:18:12"
 S ARRAY(69,1)="VOE PED VARCELLA (CHICKENPOX)" I MODE S ARRAY(69,2)="07/06/2005@18:18:29"
 S ARRAY(70,1)="VOE PED VARICELLA 2 (CHICKENPOX)" I MODE S ARRAY(70,2)="07/06/2005@18:18:50"
 S ARRAY(71,1)="VOE TD PED" I MODE S ARRAY(71,2)="07/06/2005@18:19:04"
 S ARRAY(72,1)="VOE UNIVERSAL ADLT IMMUNINZATION" I MODE S ARRAY(72,2)="07/06/2005@18:19:34"
 S ARRAY(73,1)="VOE UNIVERSAL TRAVEL" I MODE S ARRAY(73,2)="07/06/2005@18:21:28"
 S ARRAY(74,1)="VOE VACCINE CHECK" I MODE S ARRAY(74,2)="07/06/2005@18:21:45"
 S ARRAY(75,1)="VOE-DIABETIC DOQ-IT EXTRACTION" I MODE S ARRAY(75,2)="07/06/2005@18:22:02"
 Q
 ;
 ;===============================================================
CNAK ;Make sure all "NAK" characters are converted back to "^" in
 ;the Exchange File.
 N IEN,TEXT
 D BMES^XPDUTL("Clean up Exchange File entries")
 S IEN=0
 F  S IEN=+$O(^PXD(811.8,IEN)) Q:IEN=0  D
 . S TEXT=" Working on Exchange File entry "_IEN
 . D BMES^XPDUTL(TEXT)
 . D POSTKIDS^PXRMEXU5(IEN)
 Q
 ;
 ;===============================================================
DELEI ;If the Exchange File entry already exists delete it.
 N ARRAY,IC,IND,LIST,LUVALUE,NUM
 D ARRAY(1,.ARRAY)
 S IC=0
 F  S IC=$O(ARRAY(IC)) Q:'IC  D
 .S LUVALUE(1)=ARRAY(IC,1)
 .D FIND^DIC(811.8,"","","U",.LUVALUE,"","","","","LIST")
 .I '$D(LIST) Q
 .S NUM=$P(LIST("DILIST",0),U,1)
 .I NUM'=0 D
 ..F IND=1:1:NUM D
 ... N DA,DIK
 ... S DIK="^PXD(811.8,"
 ... S DA=LIST("DILIST",2,IND)
 ... D ^DIK
 Q
 ;
 ;===============================================================
DELEXB ;Delete the "B" index entries on the XML data in the Exchange File.
 N IEN
 D BMES^XPDUTL("Cleaning up Exchange File.")
 S IEN=0
 F  S IEN=+$O(^PXD(811.8,IEN)) Q:IEN=0  K ^PXD(811.8,IEN,100,"B")
 Q
 ;
 ;===============================================================
DELGEC ;Delete the GEC Referal Term sets from the Reminder Definition file
 N DA,DIK,GECREM,REMIEN
 S GECREM="VA-GEC REFERRAL TERM SET (CC)"
 S REMIEN=+$O(^PXD(811.9,"B",GECREM,0)) I REMIEN>0 D
 . S DIK="^PXD(811.9,",DA=REMIEN D ^DIK
 S GECREM="VA-GEC REFERRAL TERM SET (CR)"
 S REMIEN=+$O(^PXD(811.9,"B",GECREM,0)) I REMIEN>0 D
 . S DIK="^PXD(811.9,",DA=REMIEN D ^DIK
 S GECREM="VA-GEC REFERRAL TERM SET (NA)"
 S REMIEN=+$O(^PXD(811.9,"B",GECREM,0)) I REMIEN>0 D
 . S DIK="^PXD(811.9,",DA=REMIEN D ^DIK
 S GECREM="VA-GEC REFERRAL TERM SET (SS)"
 S REMIEN=+$O(^PXD(811.9,"B",GECREM,0)) I REMIEN>0 D
 . S DIK="^PXD(811.9,",DA=REMIEN D ^DIK
 Q
 ;
 ;===============================================================
EXFINC(Y) ;Return a 1 if the Exchange file entry is in the list to
 ;include in the build. This is used in the build to determine which
 ;entries to include.
 N ARRAY,FOUND,IEN,IC,LUVALUE
 D ARRAY(1,.ARRAY)
 S FOUND=0
 S IC=0
 F  S IC=+$O(ARRAY(IC)) Q:(IC=0)!(FOUND)  D
 . M LUVALUE=ARRAY(IC)
 . S IEN=+$$FIND1^DIC(811.8,"","KU",.LUVALUE)
 . I IEN=Y S FOUND=1 Q
 Q FOUND
 ;
 ;===============================================================
SMEXINS ;Silent mode install.
 N ARRAY,IC,IEN,LUVALUE,PXRMINST
 S PXRMINST=1
 D ARRAY(1,.ARRAY)
 S IC=0
 F  S IC=$O(ARRAY(IC)) Q:'IC  D
 .M LUVALUE=ARRAY(IC)
 .I LUVALUE(1)="GMTSMHV" Q
 .S IEN=+$$FIND1^DIC(811.8,"","KU",.LUVALUE)
 .I IEN'=0 D
 .. N TEXT
 .. I LUVALUE(1)["PARAMETER" S TEXT="Installing entry "_LUVALUE(1)
 .. E  S TEXT="Installing reminder "_LUVALUE(1)
 .. D BMES^XPDUTL(TEXT)
 .. D INSTALL^PXRMEXSI(IEN,1)
 Q
 ;
