ESPUCF2 ;DALISC/CKA - UNIFORM CRIME REPORT COUNT AND GET TOTALS- 3/33
 ;;1.0;POLICE & SECURITY;**27**;Mar 31, 1994
EN Q  ;CALLED FROM ESPUCF1
DIST ;DISTURBANCE TOTALS
OFFD ; COUNT DISTURBANCE OFFENDERS
 S ESPOF=0
 F ESPX=1:1 S ESPOF=$O(^ESP(912,ESPOFN,40,ESPOF)) Q:ESPOF'>0  D
 .  S ESPOFF=$P(^ESP(912,ESPOFN,40,ESPOF,0),U,11),^(46)=^ESP(912.3,ESPIEN,1,ESPINS,46)+1 D
 ..  I ESPTYPE=16 S ^(47)=^ESP(912.3,ESPIEN,1,ESPINS,47)+1 QUIT
 ..  I ESPTYPE=17 S ^(48)=^ESP(912.3,ESPIEN,1,ESPINS,48)+1 QUIT
 ..  I ESPTYPE=18 S ^(49)=^ESP(912.3,ESPIEN,1,ESPINS,49)+1 QUIT
 ..  I ESPTYPE=19 S ^(50)=^ESP(912.3,ESPIEN,1,ESPINS,50)+1 QUIT
 ..  I ESPTYPE=20 S ^(51)=^ESP(912.3,ESPIEN,1,ESPINS,51)+1 QUIT
 ..  I ESPTYPE=21 S ^(52)=^ESP(912.3,ESPIEN,1,ESPINS,52)+1 QUIT
 ..  I ESPTYPE=24 S ^(53)=^ESP(912.3,ESPIEN,1,ESPINS,53)+1 QUIT
 ..  I ESPTYPE=25 S ^(54)=^ESP(912.3,ESPIEN,1,ESPINS,54)+1 QUIT
 ..  I ESPTYPE=26 S ^(55)=^ESP(912.3,ESPIEN,1,ESPINS,55)+1 QUIT
 .  I ESPOFF="E"!(ESPOFF="PO") S ^(56)=^ESP(912.3,ESPIEN,1,ESPINS,56)+1 QUIT
 .  I ESPOFF="O" S ^(57)=^ESP(912.3,ESPIEN,1,ESPINS,57)+1 QUIT
 .  I ESPOFF="P" S ^(58)=^ESP(912.3,ESPIEN,1,ESPINS,58)+1 QUIT
 .  I ESPOFF="V" S ^(60)=^ESP(912.3,ESPIEN,1,ESPINS,60)+1 QUIT
 .  S ^(59)=^ESP(912.3,ESPIEN,1,ESPINS,59)+1
 QUIT
MUR ;MANSLAUGHTER/MURDER TOTALS
OFFM ;COUNT MURDER OFFENDER AND VICTIMS
 S ESPVIC=0
 F ESPX=1:1 S ESPVIC=$O(^ESP(912,ESPOFN,30,ESPVIC)) Q:ESPVIC'>0  D
 .  S ESPVICT=$P(^ESP(912,ESPOFN,30,ESPVIC,0),U,5) D
 ..  I ESPTYPE=27 S ^(61)=^ESP(912.3,ESPIEN,1,ESPINS,61)+1 QUIT
 ..  I ESPTYPE=28 S ^(62)=^ESP(912.3,ESPIEN,1,ESPINS,62)+1 QUIT
 .  I ESPVICT="E"!(ESPVICT="PO") S ^(68)=^ESP(912.3,ESPIEN,1,ESPINS,68)+1 QUIT
 .  I ESPVICT="O" S ^(69)=^ESP(912.3,ESPIEN,1,ESPINS,69)+1 QUIT
 .  I ESPVICT="P" S ^(70)=^ESP(912.3,ESPIEN,1,ESPINS,70)+1 QUIT
 .  I ESPVICT="V" S ^(71)=^ESP(912.3,ESPIEN,1,ESPINS,71)+1 QUIT
 I $D(^ESP(912,ESPOFN,30)) D OFFE
 QUIT
OFFE S ESPOF=0
 F ESPX=1:1 S ESPOF=$O(^ESP(912,ESPOFN,40,ESPOF)) Q:ESPOF'>0  D
 .  S ESPOFF=$P(^ESP(912,ESPOFN,40,ESPOF,0),U,11)
 .  I ESPOFF="E"!(ESPOFF="PO") S ^(63)=^ESP(912.3,ESPIEN,1,ESPINS,63)+1 QUIT
 .  I ESPOFF="O" S ^(64)=^ESP(912.3,ESPIEN,1,ESPINS,64)+1 QUIT
 .  I ESPOFF="P" S ^(65)=^ESP(912.3,ESPIEN,1,ESPINS,65)+1 QUIT
 .  I ESPOFF="V" S ^(67)=^ESP(912.3,ESPIEN,1,ESPINS,67)+1 QUIT
 .  S ^(66)=^ESP(912.3,ESPIEN,1,ESPINS,66)+1
 QUIT
NON ;NON-CRIMINAL TOTALS
 S ^(72)=^ESP(912.3,ESPIEN,1,ESPINS,72)+1
 I ESPTYPE=29 S ^(73)=^ESP(912.3,ESPIEN,1,ESPINS,73)+1 QUIT
 I ESPTYPE=30,ESPSUB=9 S ^(75)=^ESP(912.3,ESPIEN,1,ESPINS,75)+1 QUIT
 I ESPTYPE=30,ESPSUB=10 S ^(76)=^ESP(912.3,ESPIEN,1,ESPINS,76)+1 QUIT
 I ESPTYPE=31 S ^(77)=^ESP(912.3,ESPIEN,1,ESPINS,77)+1 QUIT
 I ESPTYPE=32 S ^(78)=^ESP(912.3,ESPIEN,1,ESPINS,78)+1 QUIT
 I ESPTYPE=33 S ^(79)=^ESP(912.3,ESPIEN,1,ESPINS,79)+1 QUIT
 I ESPTYPE=34 S ^(80)=^ESP(912.3,ESPIEN,1,ESPINS,80)+1 QUIT
 I ESPTYPE=59 S ^(188)=^ESP(912.3,ESPIEN,1,ESPINS,188)+1 QUIT
 QUIT
OTH ;OTHER OFFENSES TOTALS
 S ^(81)=^ESP(912.3,ESPIEN,1,ESPINS,81)+1
 I ESPTYPE=35 S ^(82)=^ESP(912.3,ESPIEN,1,ESPINS,82)+1 D ADOL^ESPUCF4 QUIT  ; ADOL^ESPUCF4 TOTALS DOLLAR LOSSES DUE TO ARSON.
 I ESPTYPE=37 S ^(84)=^ESP(912.3,ESPIEN,1,ESPINS,84)+1 QUIT
 I ESPTYPE=36 S ^(85)=^ESP(912.3,ESPIEN,1,ESPINS,85)+1 QUIT
 I ESPTYPE=22 S ^(86)=^ESP(912.3,ESPIEN,1,ESPINS,86)+1 QUIT
 I ESPTYPE=23 S ^(87)=^ESP(912.3,ESPIEN,1,ESPINS,87)+1 QUIT
