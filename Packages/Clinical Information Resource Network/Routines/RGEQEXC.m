RGEQEXC ;BHM/RGY-Error processor ;17-Feb-98
 ;;1.0; CLINICAL INFO RESOURCE NETWORK ;;30 Apr 99
SET(TYPE,ERROR,STUB) ;Receive Error
 NEW DIC,D0,DIE,DA,X,DLAYGO,DR,RGOK,EVN
 I $G(TYPE)="" G Q
 I TYPE'?1N.N S TYPE=$O(^RGEQASN("B",TYPE,0)) I TYPE="" G Q
 F EVN=+$P(^RGEQEXC(0),"^",3)+1:1 L +^RGEQEXC(EVN):0 I $T S RGOK=0 D  L -^RGEQEXC(EVN) Q:RGOK
   .I $D(^RGEQEXC(EVN)) Q
   .S DINUM=EVN,DIC="^RGEQEXC(",DIC(0)="L",DLAYGO=995.1,X=EVN K DD,D0 D FILE^DICN K DIC,DLAYGO,D0
   .S DIE="^RGEQEXC(",DR="[RGEQ NEW EXCEPTION]",DA=EVN D ^DIE
   .S RGOK=1
   .Q
Q Q
