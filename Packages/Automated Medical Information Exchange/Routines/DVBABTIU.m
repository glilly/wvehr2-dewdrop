DVBABTIU ;ALB/SPH - CAPRI TIU UTILITIES ;05/01/03
 ;;2.7;AMIE;**53**;Apr 10, 1995
 ;
NOTETL(Y) ; Returns list of TIU titles sorted by title
 N DVBCNT,DVBIEN
 S DVBCNT=0,DVBIEN=0,DVBDOCNM=""
 F  S DVBDOCNM=$O(^TIU(8925.1,"B",DVBDOCNM)) Q:DVBDOCNM=""  D
   .F  S DVBIEN=$O(^TIU(8925.1,"B",DVBDOCNM,DVBIEN)) Q:'DVBIEN  D
 ..;S DVBDOCNM=$P($G(^TIU(8925.1,DVBIEN,0)),"^",1)
 ..S DVBDOCTY=$P($G(^TIU(8925.1,DVBIEN,0)),"^",4)
 ..S DVBDOCST=$P($G(^TIU(8925.1,DVBIEN,0)),"^",7)
 ..S Y(DVBCNT)=DVBDOCTY_"  "_DVBDOCNM_"  "_DVBDOCST_"  IEN#"_DVBIEN,DVBCNT=DVBCNT+1
 Q
VISIT(DVBVISIT,DVBPAT,DVBVDT,DVBCLIN) ;
 N DVBIEN
 S DVBIEN=0 F  S DVBIEN=$O(^AUPNVSIT("B",DVBVDT,DVBIEN)) Q:DVBIEN=""  D
 . I $P($G(^AUPNVSIT(DVBIEN,0)),U,5)=DVBPAT D
 .. I $P($G(^AUPNVSIT(DVBIEN,0)),U,22)=DVBCLIN S DVBVISIT=DVBIEN_"^"_$P($G(^AUPNVSIT(DVBIEN,150)),U)
 Q
