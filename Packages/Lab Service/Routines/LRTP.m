LRTP ;SLC/RWF - HANDLE TASKED PROCESSING ;2/7/91  08:54 ;
 ;;5.2;LAB SERVICE;**153**;Sep 27, 1994
DQ ;
 I $D(ZTQUEUED) S ZTREQ="@"
 S LRLLOC=$S($D(LRLLOC):LRLLOC,1:""),LRSS=$S($D(LRSS):LRSS,1:0)
 D STAT:LRLLOC]""
 K ZTSK,LRCUT,LRURG
 Q
STAT N LRION
 S DA=$O(^LAB(64.6,"AS",LRLLOC,0)) G KILL:DA<1 S LRION=^LAB(64.6,DA,0),LRCUT=$P(LRION,"^",5),LRION=$P(LRION,"^",4) G KILL:LRION']"" I LRCUT'="" D URG G KILL:LRURG>LRCUT
 D KILL
 I LRSS="MI" S ZTRTN="DQ^LRMIPSZ1"
 E  S ZTRTN="DQ^LRRP2"
 S ZTIO=LRION,ZTSAVE("LR*")=""
 D ^%ZTLOAD
 Q
KILL S:$D(ZTQUEUED) ZTREQ="@" Q
URG S LRURG=9999,J=0 F  S J=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,J)) Q:J<1  S X=^(J,0) I $P(X,"^",2)<LRURG S LRURG=$P(X,"^",2)
 Q
