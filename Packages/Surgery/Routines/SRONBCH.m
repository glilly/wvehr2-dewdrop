SRONBCH ;B'HAM ISC/MAM - BATCH PRINT NURSE REPORTS ; 8 JUNE 1990 10:25 AM
 ;;3.0; Surgery ;;24 Jun 93
 S SRSOUT=0,X1=DT,X2=-1 D C^%DTC S SRSDATE=X-.0001
 F  S SRSDATE=$O(^SRF("AC",SRSDATE)) Q:'SRSDATE!(SRSDATE>DT)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSDATE,SRTN)) Q:'SRTN!SRSOUT  I $D(^SRF(SRTN,.2)),$P(^(.2),"^",3) D OP
END W:$E(IOST)="P" @IOF I $D(ZTQUEUED) Q:$G(ZTSTOP)  S ZTREQ="@" Q
 D ^%ZISC,^SRSKILL K SRSITE,SRTN
 Q
OP ; set info to print nurse report
 S SRNIGHT=1,X=$P($G(^SRF(SRTN,8)),"^"),SRSITE("SITE")=$S(X:$P(^DIC(4,X,0),"^"),1:$P($$SITE^SROVAR,"^",2))
 N SRSDATE D RPT^SRONRPT Q:SRSOUT  S X=SRTN K SRTN S SRTN=X D ^SRSKILL
 Q
