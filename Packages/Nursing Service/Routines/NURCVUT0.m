NURCVUT0 ;HIRMFO/YH,RM,FT-PATIENT SELECTION UTILITY BY WARD, ROOM OR SINGLE PATIENT ;1/31/01  14:50
 ;;4.0;NURSING SERVICE;**34**;Apr 25, 1997
 ;
 ; This routine uses the following IAs:
 ; #1940 - EN1^GMRVCAQU      (private)
 ; #1938 - CHAR^GMRVSITE     (private)
 ; #1938 - DEFAULT^GMRVSITE  (private)
 ;
WARDPAT ; SELECT ASSIGNMENT SHEET BY 1. WHOLE WARD, 2. SELECTED ROOMS ON WARD, 3. PATIENT
 S NURQUIT=0 W !,"By (U)nit, (S)elected unit rooms, or (P)atient? " R NUREDB:DTIME I "^"[NUREDB!('$T) S NURQUIT=1 Q
 S:NUREDB?1L NUREDB=$C($A(NUREDB)-32) I "Uu"[NUREDB!("Ss"[NUREDB)!("Pp"[NUREDB) G WP1
 I NUREDB?1"?".E G WARDPAT
 W !,$C(7),?5,"INVALID ENTRY ??" G WARDPAT
WP1 ;
 I "Uu"[NUREDB!("Ss"[NUREDB) D WARDSEL^NURCUT0 Q
PATDAT ; SINGLE PATIENT SELECTION
 S NASK=1,NACT=0,DIC(0)="EQMZ" D EN7^NURSCUTL Q:NURQUIT
 I "^"[X!(X="") S NURQUIT=1 D QUIT^NURCUT0 Q
 ; I +Y'>0 G PATDAT
 I '$D(^NURSF(214,+Y,0)) W !!,$C(7),"Patient is not active in Nursing System - Notify the Nursing ADP Coordinator:" G PATDAT
 D QUIT^NURCUT0
 Q
EN3 ; ENTRY FROM NURCPE-VIT VMQUALITY OPTION.
 D DEFAULT^GMRVSITE
 Q
EN2 ; ENTRY FROM NURCPE-VIT VMSITE OPTION.
 D CHAR^GMRVSITE
 Q
EN4 ;ENTRY FROM NURCPE-VIT CAT/QUAL TABLE
 D EN1^GMRVCAQU
 Q
