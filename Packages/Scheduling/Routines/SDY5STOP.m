SDY5STOP ;ALB/CAW,GTS,ESD,JAM,GT - Stop Code/DSS Identifier Update 8/2/2004
 ;;5.3;Scheduling;**388**;AUG 13, 1993
 ;
 ;**  This patch is used as a Post-Init in a KIDS build to modify the
 ;**   the DSS Identifier file [^DIC(40.7,]
 ;
EN ;** Add/inactivate/change/reactivate DSS IDs (stop codes)
 ;**  The following code executes if file modifications exist
 ;
 N SDVAR
 D:$P($T(NEW+1),";;",2)'="QUIT" ADD
 D:$P($T(CHNG+1),";;",2)'="QUIT" CHANGE
 Q
 ;
 ;
ADD ;** Add DSS IDs
 ;
 ;  SDXX is in format:
 ; STOP CODE NAME^AMIS #^RESTRICTION TYPE^REST. DATE^CDR #
 ;
 N SDX,SDXX
 S SDVAR=1
 D MES^XPDUTL("")
 D BMES^XPDUTL(">>> Adding new Clinic Stops (DSS IDs) to CLINIC STOP File (#40.7)...")
 ;
 ;** NOTE: The following line is for DSS IDs that are not yet active
 D BMES^XPDUTL(" [NOTE:  These Stop Codes CANNOT be used UNTIL 10/1/04]")
 S DIC(0)="L",DLAYGO=40.7,DIC="^DIC(40.7,"
 F SDX=1:1 K DD,DO,DA S SDXX=$P($T(NEW+SDX),";;",2) Q:SDXX="QUIT"  DO
 .S DIC("DR")="1////"_$P(SDXX,"^",2)_$S('+$P(SDXX,U,5):"",1:";4////"_$P(SDXX,"^",5))
 .S DIC("DR")=DIC("DR")_";5////"_$P(SDXX,"^",3)_";6///"_$P(SDXX,"^",4)
 .S X=$P(SDXX,"^",1)
 .I '$D(^DIC(40.7,"C",$P(SDXX,"^",2))) D FILE^DICN,MESS Q
 .;I $D(^DIC(40.7,"C",$P(SDXX,"^",2))) D EDIT(SDXX),MESSEX
 K DIC,DLAYGO,X
 Q
 ;
EDIT(SDXX) ;- Edit fields w/new values if stop code record already exists
 ;
 Q:$G(SDXX)=""
 N DA,DIE,DLAYGO,DR
 S DA=+$O(^DIC(40.7,"C",+$P(SDXX,"^",2),0))
 Q:'DA
 S DIE="^DIC(40.7,",DR=".01////"_$P(SDXX,"^")_";1////"_$P(SDXX,"^",2)_";2////@"_$S('+$P(SDXX,U,5):"",1:";4////"_$P(SDXX,"^",5))_";5////"_$P(SDXX,"^",3)_";6///"_$P(SDXX,"^",4)
 D ^DIE
 Q
 ;
CHANGE ;** Change DSS ID names
 ;
 ;  SDXX is in format:
 ; STOP CODE NAME^AMIS #^^NEW STOP CODE NAME
 ;
 N SDX,SDXX,SDDA
 S SDVAR=1
 D MES^XPDUTL("")
 D BMES^XPDUTL(">>> Changing Clinic Stop (DSS ID) names in CLINIC STOP File (#40.7)...")
 F SDX=1:1 K DD,DO,DA S SDXX=$P($T(CHNG+SDX),";;",2) Q:SDXX="QUIT"  DO
 .S SDDA=+$O(^DIC(40.7,"C",$P(SDXX,U,2),0))
 .I $D(^DIC(40.7,SDDA,0)) DO
 ..S DA=SDDA,DR=".01///"_$P(SDXX,U,4),DIE="^DIC(40.7,"
 ..D ^DIE,MESC
 K DIE,DR,DA
 Q
 ;
MESS ;** Add message
 N ECXADMSG
 I +$G(SDVAR) D HDR(SDVAR)
 D MES^XPDUTL(" ")
 S ECXADMSG="Added:       "_$P(SDXX,"^",2)_"      "_$P(SDXX,"^")
 I $P(SDXX,"^",5)'="" S ECXADMSG=ECXADMSG_" [CDR#: "_$P(SDXX,"^",5)_"]"
 D MES^XPDUTL(ECXADMSG)
 I $P(SDXX,"^",3)'="" S ECXADMSG="                      Restricted Type: "_$P(SDXX,"^",3)_"    Restricted Date: "_$P(SDXX,"^",4)
 D MES^XPDUTL(ECXADMSG)
 K SDVAR
 Q
 ;
MESSEX ;** Display message if stop code already exists
 N ECXADMSG
 I +$G(SDVAR) D HDR(SDVAR)
 D MES^XPDUTL(" ")
 S ECXADMSG="             "_$P(SDXX,"^",2)_"      "_$P(SDXX,"^")_"  already exists."
 D MES^XPDUTL(ECXADMSG)
 K SDVAR
 Q
 ;
MESC ;** Change message
 N SDCMSG,SDCMSG1
 I +$G(SDVAR) D HDR(SDVAR)
 D MES^XPDUTL(" ")
 S SDCMSG="Changed:      "_$P(SDXX,U,2)_"           "_$P(SDXX,U)
 S SDCMSG1="     to:      "_$P(SDXX,U,2)_"           "_$P(SDXX,U,4)
 D MES^XPDUTL(SDCMSG)
 D MES^XPDUTL(SDCMSG1)
 K SDVAR
 Q
 ;
HDR(SDVAR) ;- Header
 Q:'$G(SDVAR)
 N SDHDR
 S SDHDR=$P($T(@("HDR"_SDVAR)),";;",2)
 D BMES^XPDUTL(SDHDR)
 Q
 ;
 ;
HDR1 ;;           Stop Code              Name
 ;
HDR2 ;;                CDR        Stop Code             Name
 ;
HDR3 ;;           Stop Code      Name                       Rest. Type    Date
 ;
NEW ;DSS IDs to add- ex ;;STOP CODE NAME^NUMBER^RESTRICTION TYPE^RESTRICTION DATE^CDR
 ;;HBPC Nursing (RN / LP)^171^P^10/1/2004
 ;;HBPC PHYSIC EXTND(NP,CNS,PA)^172^P^10/1/2004
 ;;PMRS CWT/TWE FACE TO FACE^208^E
 ;;COMP & PENS (C&P) EXAMS^450^S^10/1/2004
 ;;TRANSPLANT^457^S^10/1/2004
 ;;RESEARCH^474^S^10/1/2004
 ;;COMPREHENSIVE FUNDOSCOPY EXAM^480^S^10/1/2004
 ;;BRONCHOSCOPY^481^S^10/1/2004
 ;;PTSD CLINICAL TEAM PTS IND^540^P^10/1/2004
 ;;MH CWT/TWE FACE TO FACE^574^E
 ;;ADMIN PAT ACTIVTIES (MASNONCT)^674^P^10/1/2004
 ;;NON-VIDEO MONITORING ONLY^683^P^10/1/2004
 ;;CARE OF CCS PROGRAM PATIENT^685^E
 ;;PMRS CWT/SE FACE TO FACE^222^E^
 ;;PMRS CWT/SE NON-F TO F (MASNONCT)^223^E
 ;;PMRS CWT/TWE NON-F TO F (MASNONCT)^228^E
 ;;MEDICAL PRE-PROCED EVAL^336^E^
 ;;MOVE PROGRAM IND^372^E^
 ;;MOVE PROGRAM GRP^373^E^
 ;;LOCALLY DEFINED^451^S^10/1/2004
 ;;LOCALLY DEFINED^452^S^10/1/2004
 ;;LOCALLY DEFINED^453^S^10/1/2004
 ;;LOCALLY DEFINED^454^S^10/1/2004
 ;;LOCALLY DEFINED^455^S^10/1/2004
 ;;LOCALLY DEFINED^456^S^10/1/2004
 ;;LOCALLY DEFINED^458^S^10/1/2004
 ;;LOCALLY DEFINED^459^S^10/1/2004
 ;;LOCALLY DEFINED^460^S^10/1/2004
 ;;LOCALLY DEFINED^461^S^10/1/2004
 ;;LOCALLY DEFINED^462^S^10/1/2004
 ;;LOCALLY DEFINED^463^S^10/1/2004
 ;;LOCALLY DEFINED^464^S^10/1/2004
 ;;LOCALLY DEFINED^465^S^10/1/2004
 ;;LOCALLY DEFINED^466^S^10/1/2004
 ;;LOCALLY DEFINED^467^S^10/1/2004
 ;;LOCALLY DEFINED^468^S^10/1/2004
 ;;LOCALLY DEFINED^469^S^10/1/2004
 ;;LOCALLY DEFINED^470^S^10/1/2004
 ;;LOCALLY DEFINED^471^S^10/1/2004
 ;;LOCALLY DEFINED^472^S^10/1/2004
 ;;LOCALLY DEFINED^473^S^10/1/2004
 ;;LOCALLY DEFINED^475^S^10/1/2004
 ;;LOCALLY DEFINED^476^S^10/1/2004
 ;;LOCALLY DEFINED^477^S^10/1/2004
 ;;LOCALLY DEFINED^478^S^10/1/2004
 ;;LOCALLY DEFINED^479^S^10/1/2004
 ;;LOCALLY DEFINED^482^S^10/1/2004
 ;;LOCALLY DEFINED^483^S^10/1/2004
 ;;LOCALLY DEFINED^484^S^10/1/2004
 ;;LOCALLY DEFINED^485^S^10/1/2004
 ;;MH CWT/SE FACE TO FACE^568^E^
 ;;MH CWT/SE NON-F TO F (MAS NONCT^569^E^
 ;;MH CWT/TWE NON-F TO F (MAS NONCT^570^E^
 ;;SEND-OUT PROCS RADIOLOGY^643^P^10/1/2004
 ;;STATE HOME ADULT DAY HLTHCARE^658^P^10/1/2004
 ;;QUIT
 ;
CHNG ;DSS ID name changes- example ;;STOP CODE NAME^NUMBER^^NEW NAME
 ;;HBPC - RN/RNP/PA//^171^^HBPC Nursing (RN / LP)
 ;;HBPC - NURSE EXTENDER^172^^HBPC PHYSIC EXTND(NP,CNS,PA)
 ;;PM&RS COMPENSATED WORK THERAPY^208^^PMRS CWT/TWE FACE TO FACE
 ;;COMP & PENS (C&P) EXAMS^450^^COMP & PENS (C&P) EXAMS
 ;;TRANSPLANT^457^^TRANSPLANT
 ;;RESEARCH^474^^RESEARCH
 ;;COMPREHENSIVE FUNDOSCOPY EXAM^480^^COMPREHENSIVE FUNDOSCOPY EXAM
 ;;BRONCHOSCOPY^481^^BRONCHOSCOPY
 ;;PCT POST-TRAUMATIC STRESS-IND^540^^PTSD CLINICAL TEAM PTS IND
 ;;MH COMP WORK THERAPY (CWT) GRP^574^^MH CWT/TWE FACE TO FACE
 ;;ADMIN PT ORIENT NONCTMAS PRI^674^^ADMIN PAT ACTIVTIES (MASNONCT)
 ;;NONVIDEO HOME TELEHEALTH MONITOR ONLY (NONCOUNT)^683^^NON-VIDEO MONITORING ONLY
 ;;CCS OFFICE VISIT^685^^CARE OF CCS PROGRAM PATIENT
 ;;QUIT
