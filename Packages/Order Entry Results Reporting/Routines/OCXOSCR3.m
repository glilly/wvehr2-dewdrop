OCXOSCR3 ;SLC/RJS,CLA -  message xref for the Order Check Patient Rule Event File;1/05/04  14:56
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**32,221**;Dec 17,1997
 ;;  ;;ORDER CHECK EXPERT version 1.01 released OCT 29,1998
 ;
 Q
 ;
SET(OCXX,OCXD0,OCXD1) ;
 ;
 N OCXM,OCXC,OCXP,OCXA,OCXO
 ;
 S OCXC=0
 S OCXO=+$P($G(^OCXD(860.7,OCXD0,1,OCXD1,0)),U,3)
 S OCXM=$G(^OCXD(860.7,OCXD0,1,OCXD1,"M")) Q:'$L(OCXM)
 ;
 F OCXP=1:1:$L(OCXM) D
 .S OCXA=$A(OCXM,OCXP)-30 Q:(OCXA<1)
 .S OCXC=OCXC+OCXA,OCXC=OCXC+(OCXP-1*100)
 ;
 S ^OCXD(860.7,"AT",OCXX,OCXD0,OCXD1,OCXO,OCXC)=($H*86400)+$P($H,",",2)
 ;
 Q
 ;
