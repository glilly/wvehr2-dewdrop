NURSDD ;HIRMFO/RM-THIS ROUTINE PRINTS OUT DD'S FOR NURSING FILES ;12/30/87
 ;;4.0;NURSING SERVICE;;Apr 25, 1997
 ;LAST MODIFIED BY RM;12/30/87
 Q:'$D(^DIC(213.9,1,"OFF"))  Q:$P(^DIC(213.9,1,"OFF"),"^",1)=1
 S X="DID" X ^%ZOSF("TEST") Q:'$T
 D DT^DICRW S NURQUEUE=0
DEV S %ZIS="Q" D ^%ZIS K %ZIS K:POP IO("Q") G:POP QUIT I '($E(IOST)="P"),'$D(IO("Q")) S XQH="NURS-PRINTER QUEUE" W $C(7) D EN^XQH D ^%ZISC G DEV
 S NURQUEUE=0 I $D(IO("Q")) K IO("Q"),IO("C") S NURQUEUE=1,ZTDESC="Nursing DD Listing",ZTRTN="LATER^NURSDD",ZTIO=ION_";"_IOST_";"_IOM_";"_IOSL D ^%ZTLOAD S NURQUEUE=0
 Q
LATER S NURSION=ION
 F NURSFILE=209.99999:0 S NURSFILE=$O(^DIC(NURSFILE)) Q:NURSFILE'<220!(NURSFILE="")  D SETVAR,EN^DID
QUIT ; KILL LOCAL VARIABLES
 S:$G(POP) NUROUT=1 D CLOSE^NURSUT1,^NURSKILL
 Q
SETVAR ; SETS VARIABLES TO PRINT DD
 S DIC=NURSFILE,DIFORMAT=1,IOP=ION
 Q
