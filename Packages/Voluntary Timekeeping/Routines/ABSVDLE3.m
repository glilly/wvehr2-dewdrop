ABSVDLE3 ;EAP ALTOONA TEMPORARY RECEIPTS  ; 26 Sep 2001  2:04 PM
V ;;4.0;VOLUNTARY TIMEKEEPING;**25,26**;JULY 6, 1994
 ;PRINTOUT TEMPORARY RECEIPT FROM DONATIONS FILE & CREATE LOG FILE ENTRY IN 503344
WRITE ;
 I '$D(ABSVNUMB) QUIT
 S U="^" I '$D(IOM) S IOM=80
 W ! F I=1:1:IOM W "="
 I '$D(^ABS(503344,ABSVNUMB,0)) W !,"ENTRY IS NOT DEFINED IN FILE 503344" QUIT
 S ABSVDOLA=ABSVAMOU D DOLL^ABSVDLE1 S ABSVAMOU=ABSVDOLA
 I ABSVORG="" W !,"NO ORGANIZATION NAME FOR THIS ENTRY" Q
 W !,ABSVORG,?31,"| TYPE OF FUNDS | AMOUNT: ",ABSVAMOU
 W !,ABSVNAME,?31,"|  CASH/CHECK   | ISSUED BY: ",ABSVISS
 W !,ABSVSTRE,?31,"|               | DATE ISSUED: ",ABSVDATE
 I ABSVSTR2'="" D ADDRESS G SKIP
 I ABSVSTR2="" D NOADD
SKIP W ! F I=1:1:IOM W "="
 W !,"POST: ",ABSVPOSF,?31,"| FUND: ",ABSVFUND," #",ABSVGPFN
 W ! F I=1:1:IOM W "="
 W !,"PURPOSE OF DONATION: ",ABSVPURP
SET ;SET PIECES INTO 503344
 S ABSVDALL=ABSVNUMB_U_ABSVNAME_U_ABSVSTRE_U_ABSVCITY_U_"C"_U_ABSVAMOU_U_ABSVISS_U_ABSVRAWD_U_ABSVREF_U_ABSVSTR2_U_ABSVORGN_U_ABSVPURP
 S ABSVTWO=ABSVPOSF_U_ABSVFUND_U_ABSVPURP_U_ABSVORG
 S ^ABS(503344,ABSVNUMB,0)=ABSVDALL
 S ^ABS(503344,ABSVNUMB,1)=ABSVTWO
 Q
END ;
 Q
ADDRESS ;
 W !,ABSVSTR2,?31,"|               | LOG FILE#: ",ABSVNUMB
 W !,ABSVCITY,?31,"|               |"
 Q
NOADD ;
 W !,ABSVCITY,?31,"|               | LOG FILE#: ",ABSVNUMB
 Q
CREATE ;CREATE FILE 503344 ENTRY
 S DIC="^ABS(503344,",DLAYGO=503344,DIC(0)="LM" D NOW^%DTC S DT=X
GET L ^ABS("RECEIPT") S X=$S($D(^ABS("RECEIPT")):+^("RECEIPT")+1,1:1),^("RECEIPT")=X L  G:$D(^ABS(503344,X)) GET S DINUM=X D FILE^DICN G:+Y<0 GET
 W !!,"THIS TEMPORARY RECEIPT LOG ENTRY HAS BEEN ASSIGNED NUMBER: ",+Y S ABSVNUMB=+Y
 Q
DOLLAR ;
 I '$D(ABSVDOLL) Q
 I ABSVDOLL="" Q
 I ABSVDOLL'["." S ONE=ABSVDOLL S TWO="00"
 I ABSVDOLL["." S ONE=$P(ABSVDOLL,".",1) S TWO=$P(ABSVDOLL,".",2) I $L(TWO)<2 S TWO=TWO_"0"
 S LEN=$L(ONE)
 I LEN<3 S ABSVDOLL="$"_ONE_"."_TWO
 I LEN=3 S ABSVDOLL="$"_ONE_"."_TWO
 I LEN=4 S ABSVDOLL="$"_$E(ONE,1)_","_$E(ONE,2,4)_"."_TWO
 I LEN=5 S ABSVDOLL="$"_$E(ONE,1,2)_","_$E(ONE,3,5)_"."_TWO
 I LEN=6 S ABSVDOLL="$"_$E(ONE,1,2)_","_$E(ONE,3,6)_"."_TWO
 I LEN=7 S ABSVDOLL="$"_$E(ONE,1,2)_","_$E(ONE,3,7)_"."_TWO
 K ONE,TWO
 Q
LINER W !,"====================================================================="
 Q
