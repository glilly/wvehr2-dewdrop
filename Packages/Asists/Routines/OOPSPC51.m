OOPSPC51 ;HIRMFO/YH-SUPERVISOR'S REPORT,  CA2 FORM ;6/14/98
 ;;2.0;ASISTS;;Jun 03, 2002
 ;SUPERVISOR'S REPORT
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA2H"))
 ; Patch 8 added agency code, 8/29/00 changed to pull from fld 70
 W !,"PU0.8,27.4;LB"_$P(OOPSDATA,"^")_"@;"_"PU17.7,27.4;LB"_$$GET1^DIQ(2260,IEN,"70:.01")_"@;"
 W "PU0.8,26.5;LB"_$P(OOPSDATA,"^",2)_"@;"
 W !,"PU0.8,25.7;LB"_$P(OOPSDATA,"^",3)_", "_$P($G(^DIC(5,+$P(OOPSDATA,"^",4),0)),"^")_"@;PU12,25.7;LB"_$P(OOPSDATA,"^",5)_"@;"
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA2I"))
 W !,"PU0.8,24.8;LB"_$P(OOPSDATA,"^")_"   "_$P(OOPSDATA,"^",2)_" "_$P(OOPSDATA,"^",3)_", "_$P($G(^DIC(5,+$P(OOPSDATA,"^",4),0)),"^")_"@;"
 W !,"PU17.5,24.8;LB"_$P(OOPSDATA,"^",5)_"@;"
 S OOPSP=$P(OOPSDATA,"^",6),OOPSP=$S(OOPSP="MID":"12:00A",OOPSP="NOON":"12:00P",1:OOPSP)
 I OOPSP'="" W !,"PU3,23.8;LB"_$E(OOPSP,1,2)_"@;PU3.6,23.8;LB"_$E(OOPSP,4,5)_"@;"_$S(OOPSP["A":"PU4.1,24.2;LBX@;",OOPSP["P":"PU4.1,23.8;LBX@;",1:"")
 S OOPSP=$P(OOPSDATA,"^",7),OOPSP=$S(OOPSP="MID":"12:00A",OOPSP="NOON":"12:00P",1:OOPSP)
 I OOPSP'="" W !,"PU6.3,23.8;LB"_$E(OOPSP,1,2)_"@;PU6.9,23.8;LB"_$E(OOPSP,4,5)_"@;"_$S(OOPSP["A":"PU7.4,24.2;LBX@;",OOPSP["P":"PU7.4,23.8;LBX@;",1:"")
 I +$P(OOPSDATA,"^",8)>0 D WKSCHDUL^OOPSPUT1($P(OOPSDATA,"^",8),"11,23.8","12.3,23.8","13.6,23.8","14.9,23.8","16.2,23.8","17.7,23.8","18.8,23.8") ;WORK SCHEDULE
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA2J"))
 W !,"PU0.8,22.7;LB"_$P(OOPSDATA,"^")_"@;" ;NAME OF PHYSICIAN
 W !,"PU0.8,21.9;LB"_$P(OOPSDATA,"^",2)_"@;" ;ADDRESS OF PHYSICIAN
 W !,"PU0.8,21.1;LB"_$P(OOPSDATA,"^",3)_$S(+$P(OOPSDATA,"^",4)>0:", "_$P($G(^DIC(5,+$P(OOPSDATA,"^",4),0)),"^"),1:"")_"   "_$P(OOPSDATA,"^",5)_"@;" ;CITY, STATE AND ZIP CODE
 S OOPSP=$P(OOPSDATA,"^",6) I OOPSP'="" D WDATE^OOPSPUT1(OOPSP,"17.5,22.5","18.4,22.5","19.2,22.5")
 S OOPSP=$P(OOPSDATA,"^",7) ;SHOW EMPLOYEE IS DISABLED FOR WORK
 W !,$S(OOPSP="Y":"PU17.5,21.7;LBX@;",OOPSP="N":"PU18.9,21.7LBX@;",1:"")
 S OOPSP=$P(OOPSDATA,"^",8) I OOPSP'="" D WDATE^OOPSPUT1(OOPSP,"3.4,20.2","4.3,20.2","5.2,20.2") ;DATE REPORT TO SUPERVISOR 
 S OOPSP=$P(OOPSDATA,"^",9) I OOPSP'="" D
 . D WDATE^OOPSPUT1($P(OOPSP,"."),"9.4,20.2","10.2,20.2","11.1,20.2") ;DATE STOPPED WORK
 . D WTIME^OOPSPUT1($P(OOPSP,".",2)_"0000","14.5,20.4","14.5,20","13,20.1","13.9,20.1")
 S OOPSP=$P(OOPSDATA,"^",10) I OOPSP'="" D
 . D WDATE^OOPSPUT1($P(OOPSP,"."),"3.6,18.9","4.4,18.9","5.2,18.9") ;DATE STOPPED PAY
 . D WTIME^OOPSPUT1($P(OOPSP,".",2)_"0000","8.5,19.1","8.5,18.7","7.2,18.8","7.9,18.8")
 S OOPSP=$P(OOPSDATA,"^",11) I OOPSP'="" D WDATE^OOPSPUT1(OOPSP,"14.3,18.9","15.1,18.9","16,18.9") ;DATE LAST EXPOSED
 S OOPSP=$P(OOPSDATA,"^",12) I OOPSP'="" D
 . D WDATE^OOPSPUT1($P(OOPSP,"."),"2.7,17.6","3.5,17.6","4.4,17.6") ;DATE RETURNED TO WORK
 . D WTIME^OOPSPUT1($P(OOPSP,".",2)_"0000","7.8,17.7","7.8,17.3","6.3,17.5","7.1,17.5")
 S OOPSNODE="CA2K",OOPSDIWL=1,OOPSDIWR="",OOPSDIWF="C100",OOPSBS=7
 S OOPSSEL="W !,$S(II=1:""PU0.8,16.3;LB"",II=2:""PU0.8,15.9;LB"",II=3:""PU0.8,15.5;LB"",II=4:""PU0.8,15.1;LB"",II=5:""PU0.8,14.7;LB"""
 S OOPSSEL=OOPSSEL_",II=6:""PU0.8,14.3;LB"",II=7:""PU0.8,13.9;LB"",1:"""")_$G(^UTILITY($J,""W"",1,II,0))_""@;"""
 S OOPSAT="W !,""PU.8,16.2,12.3;LBSee Attached@;"""
 S OOPSLBL="31. If employee has returned to work and work assignment has changed,"
 I $D(^OOPS(2260,IEN,OOPSNODE,0)) D
 .D WP^OOPSPCA(OOPSDIWL,OOPSDIWR,OOPSDIWF,OOPSBS,OOPSNODE,OOPSSEL,OOPSAT,OOPSLBL)
 ; Patch 8
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA"))
 S OOPSR=$P(OOPSDATA,U,4)
 W !,$S(OOPSR=1:"PU7.2,13.2;LBX@;",OOPSR=2:"PU9.2,13.2;LBX@",OOPSR=3:"PU11.2,13.2;LBX@;",1:"")
 I OOPSR=3 W !,"PU1,12.7;LB"_$P(OOPSDATA,U,5)_"@;"
 K OOPSR
 ;INJURY CAUSED BY 3RD PARTY
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA2L"))
 S OOPSP=$P(OOPSDATA,"^")
 W !,$S(OOPSP="Y":"PU0.9,11.5;LBX@;",OOPSP="N":"PU2.3,11.5;LBX@;",1:"")
 I OOPSP="Y" D
 . W !,"PU3.8,11.8;LB"_$P(OOPSDATA,"^",2)_"@;"
 . W !,"PU3.8,11;LB"_$P(OOPSDATA,"^",3)_"@;"
 . W !,"PU3.8,10.2;LB"_$P(OOPSDATA,"^",4)_$S(+$P(OOPSDATA,"^",5)>0:", "_$P($G(^DIC(5,+$P(OOPSDATA,"^",5),0)),"^"),1:"")_"   "_$P(OOPSDATA,"^",6)_"@;"
 W !,"PU1,7.5;LB"_$P($G(^OOPS(2260,IEN,"CA2L")),"^",7)_"@;"
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA2ES"))
 S OOPSP=$P($G(^VA(200,+$P(OOPSDATA,"^",4),0)),"^") ;SUPERVISOR'S NAME
 W !,"PU0.8,5.5;LB"_OOPSP_"@;"
 I $P(OOPSDATA,"^",5)'="" W !,"PU0.8,4.7;LB/ES/ "_OOPSP_"@;"
 I $P(OOPSDATA,"^",5)'="",$P(OOPSDATA,"^",6)'="" W !,"PU12.5,4.7;LB"_$$FMTE^XLFDT($P(OOPSDATA,"^",6),2)_"@;"
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA2H"))
 W !,"PU0.8,3.8;LB"_$P(OOPSDATA,"^",8)_"@;PU12.4,3.8;LB"_$P(OOPSDATA,"^",9)_"@;"
 Q
